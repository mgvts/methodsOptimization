========================================================================================================================
TIME. PROFILING: Minibatch CD. # 0
========================================================================================================================
         8062961 function calls in 1.381 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.381    1.381 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:24(<lambda>)
        1    0.012    0.012    1.381    1.381 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:43(stochastic_grad_down)
    10000    0.394    0.000    1.358    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   687965    0.109    0.000    0.729    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687965    0.314    0.000    0.620    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   687965    0.185    0.000    0.245    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.090    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.055    0.000    0.061    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2063895    0.061    0.000    0.061    0.000 {built-in method _operator.index}
  1385930    0.049    0.000    0.049    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.043    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   881270    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    90001    0.022    0.000    0.025    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   687965    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   170001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD. # 0
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:169: 0.3 KiB
    self._getitem = False
#2: lab2/linear_regression.py:34: 0.2 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
#3: lab2/linear_regression.py:47: 0.1 KiB
    b -= alpha * self.get_grad_in_point(b)
Total allocated size: 0.6 KiB
========================================================================================================================
TIME. PROFILING: Minibatch CD. # 1
========================================================================================================================
         8051025 function calls in 1.380 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.380    1.380 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:24(<lambda>)
        1    0.012    0.012    1.380    1.380 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:43(stochastic_grad_down)
    10000    0.394    0.000    1.357    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   686787    0.105    0.000    0.727    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   686787    0.316    0.000    0.622    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   686787    0.185    0.000    0.245    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.091    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.055    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2060361    0.061    0.000    0.061    0.000 {built-in method _operator.index}
  1383574    0.049    0.000    0.049    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.043    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   879936    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    90001    0.022    0.000    0.026    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   686787    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.020    0.000    0.020    0.000 {method 'append' of 'list' objects}
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   170001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD. # 1
========================================================================================================================
Top 5 lines
#1: lab2/linear_regression.py:34: 0.2 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: Minibatch CD. # 2
========================================================================================================================
         8062060 function calls in 1.379 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.379    1.379 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:24(<lambda>)
        1    0.012    0.012    1.379    1.379 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:43(stochastic_grad_down)
    10000    0.394    0.000    1.356    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   687998    0.109    0.000    0.728    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687998    0.314    0.000    0.619    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   687998    0.184    0.000    0.244    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.035    0.000    0.090    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.055    0.000    0.061    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2063994    0.061    0.000    0.061    0.000 {built-in method _operator.index}
  1385996    0.049    0.000    0.049    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.043    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880072    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    90001    0.022    0.000    0.025    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   687998    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.020    0.000    0.020    0.000 {method 'append' of 'list' objects}
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   170001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD. # 2
========================================================================================================================
Top 5 lines
#1: lab2/linear_regression.py:34: 0.2 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: Minibatch CD. # 3
========================================================================================================================
         8065058 function calls in 1.384 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.384    1.384 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:24(<lambda>)
        1    0.012    0.012    1.384    1.384 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:43(stochastic_grad_down)
    10000    0.396    0.000    1.361    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688201    0.105    0.000    0.729    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688201    0.317    0.000    0.624    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688201    0.186    0.000    0.245    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.091    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.055    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2064603    0.061    0.000    0.061    0.000 {built-in method _operator.index}
  1386402    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.043    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   881243    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    90001    0.022    0.000    0.025    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688201    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   170001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD. # 3
========================================================================================================================
Top 5 lines
#1: lab2/linear_regression.py:34: 0.2 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: Minibatch CD. # 4
========================================================================================================================
         8072821 function calls in 1.386 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.386    1.386 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:24(<lambda>)
        1    0.012    0.012    1.386    1.386 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:43(stochastic_grad_down)
    10000    0.396    0.000    1.362    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688976    0.110    0.000    0.732    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688976    0.316    0.000    0.622    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688976    0.185    0.000    0.245    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.035    0.000    0.090    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.055    0.000    0.061    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2066928    0.061    0.000    0.061    0.000 {built-in method _operator.index}
  1387952    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.043    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   882031    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    90001    0.022    0.000    0.025    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688976    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    20000    0.004    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   170001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD. # 4
========================================================================================================================
Top 5 lines
#1: lab2/linear_regression.py:34: 0.2 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: Minibatch CD Pytorch. # 0
========================================================================================================================
         7994660 function calls (7984652 primitive calls) in 2.602 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.858    2.858 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:28(<lambda>)
        1    0.000    0.000    2.858    2.858 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:83(stochastic_grad_down)
        1    0.033    0.033    2.850    2.850 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.483    0.000    2.171    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   687976    0.113    0.000    0.746    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687976    0.320    0.000    0.634    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.389    0.000    0.389    0.000 {built-in method torch.tensor}
   687976    0.190    0.000    0.250    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10001    0.248    0.000    0.248    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
    10000    0.027    0.000    0.206    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
    10000    0.008    0.000    0.188    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
    10000    0.016    0.000    0.179    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
30000/20000    0.022    0.000    0.178    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.136    0.000    0.136    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.011    0.000    0.119    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.015    0.000    0.095    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.004    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.013    0.000    0.089    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.022    0.000    0.071    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.067    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2063928    0.063    0.000    0.063    0.000 {built-in method _operator.index}
    10000    0.008    0.000    0.047    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    10000    0.009    0.000    0.047    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.047    0.000    0.047    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.010    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    20000    0.021    0.000    0.041    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
    20000    0.004    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   880391    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    10000    0.034    0.000    0.034    0.000 {built-in method torch._C._nn.linear}
    20000    0.031    0.000    0.031    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.021    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   707986    0.028    0.000    0.028    0.000 {built-in method builtins.len}
   687976    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    10000    0.008    0.000    0.025    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
   570054    0.024    0.000    0.024    0.000 {method 'append' of 'list' objects}
    10000    0.013    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.004    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.017    0.000    0.017    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
    20000    0.012    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    10000    0.008    0.000    0.013    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20000    0.013    0.000    0.013    0.000 {built-in method torch._ops.profiler.}
    20004    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
        1    0.000    0.000    0.007    0.007 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.006    0.006 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
    10000    0.006    0.000    0.006    0.000 {built-in method torch.broadcast_tensors}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
20001/20000    0.003    0.000    0.004    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
    20000    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
        2    0.003    0.002    0.003    0.002 {built-in method torch.empty}
30076/30072    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
    10002    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    40002    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.002    0.002 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.002    0.002 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
    10004    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
        2    0.002    0.001    0.002    0.001 {method 'uniform_' of 'torch._C._TensorBase' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
        4    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        4    0.001    0.000    0.001    0.000 {built-in method _make_subclass}
        2    0.001    0.000    0.001    0.000 {method 'float' of 'torch._C._TensorBase' objects}
    10009    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10005    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
      2/1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:479(__getitem__)
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:702(Optional)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        3    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:168(_type_check)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:447(__getattr__)
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:658(Union)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:159(_type_convert)
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:845(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.compile}
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:1353(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._get_operation_overload}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:239(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:262(profile_hook_step)
        7    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:1297(__setattr__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:1258(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        3    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:694(<genexpr>)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:247(_collect_parameters)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:35(update_wrapper)
        7    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:1245(_is_dunder)
       17    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:895(__eq__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:313(_remove_dups_flatten)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._get_schema}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        2    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:904(__hash__)
        8    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:299(_deduplicate)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:65(wraps)
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        3    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:1358(<genexpr>)
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hash}
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:458(__repr__)
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD Pytorch. # 0
========================================================================================================================
Top 5 lines
#1: torch/_ops.py:502: 2.2 KiB
    return self._op(*args, **kwargs or {})
#2: linear/pytorch_linear_regression.py:13: 1.9 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#3: torch/functional.py:74: 1.3 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/sgd.py:47: 0.1 KiB
    state = self.state[p]
#5: modules/module.py:1626: 0.1 KiB
    params = self.__dict__.get('_parameters')
14 other: 1.1 KiB
Total allocated size: 6.7 KiB
========================================================================================================================
TIME. PROFILING: Minibatch CD Pytorch. # 1
========================================================================================================================
         7994859 function calls (7984853 primitive calls) in 2.623 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.882    2.882 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:28(<lambda>)
        1    0.000    0.000    2.882    2.882 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:83(stochastic_grad_down)
        1    0.035    0.035    2.882    2.882 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.491    0.000    2.205    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   687982    0.110    0.000    0.760    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687982    0.327    0.000    0.650    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.394    0.000    0.394    0.000 {built-in method torch.tensor}
   687982    0.197    0.000    0.259    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10001    0.252    0.000    0.252    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
    10000    0.028    0.000    0.213    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
30000/20000    0.023    0.000    0.178    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.008    0.000    0.177    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
    10000    0.016    0.000    0.168    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
    10000    0.123    0.000    0.123    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.012    0.000    0.121    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.016    0.000    0.097    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.004    0.000    0.092    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.014    0.000    0.089    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.023    0.000    0.072    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.067    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2063946    0.064    0.000    0.064    0.000 {built-in method _operator.index}
    10000    0.009    0.000    0.048    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    20000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    10000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.045    0.000    0.045    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.021    0.000    0.042    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
   880680    0.037    0.000    0.037    0.000 {method 'getrandbits' of '_random.Random' objects}
    20000    0.004    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    10000    0.033    0.000    0.033    0.000 {built-in method torch._C._nn.linear}
    20000    0.032    0.000    0.032    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.021    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   707988    0.028    0.000    0.028    0.000 {built-in method builtins.len}
   687982    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
   570051    0.025    0.000    0.025    0.000 {method 'append' of 'list' objects}
    10000    0.008    0.000    0.025    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
    10000    0.014    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.012    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    20000    0.016    0.000    0.016    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
    20000    0.014    0.000    0.014    0.000 {built-in method torch._ops.profiler.}
    10000    0.008    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20004    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
    10000    0.006    0.000    0.006    0.000 {built-in method torch.broadcast_tensors}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
    20000    0.004    0.000    0.004    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
    20000    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
30042/30038    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
    40002    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    10002    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
    10003    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
    10001    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10004    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD Pytorch. # 1
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 1.7 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 1.4 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 1.2 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
4 other: 0.2 KiB
Total allocated size: 4.8 KiB
========================================================================================================================
TIME. PROFILING: Minibatch CD Pytorch. # 2
========================================================================================================================
         7988762 function calls (7978756 primitive calls) in 2.628 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.887    2.887 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:28(<lambda>)
        1    0.000    0.000    2.887    2.887 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:83(stochastic_grad_down)
        1    0.035    0.035    2.887    2.887 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.491    0.000    2.206    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   687424    0.114    0.000    0.757    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687424    0.324    0.000    0.643    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.396    0.000    0.396    0.000 {built-in method torch.tensor}
   687424    0.192    0.000    0.254    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10001    0.253    0.000    0.253    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
    10000    0.029    0.000    0.215    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
    10000    0.008    0.000    0.179    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
30000/20000    0.023    0.000    0.178    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.016    0.000    0.170    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
    10000    0.124    0.000    0.124    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.012    0.000    0.122    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.016    0.000    0.098    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.004    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.014    0.000    0.089    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.023    0.000    0.072    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.067    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2062272    0.064    0.000    0.064    0.000 {built-in method _operator.index}
    10000    0.009    0.000    0.049    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    20000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    10000    0.009    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.045    0.000    0.045    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.022    0.000    0.042    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
   879047    0.037    0.000    0.037    0.000 {method 'getrandbits' of '_random.Random' objects}
    20000    0.004    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    10000    0.033    0.000    0.033    0.000 {built-in method torch._C._nn.linear}
    20000    0.032    0.000    0.032    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.021    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   707430    0.028    0.000    0.028    0.000 {built-in method builtins.len}
   687424    0.026    0.000    0.026    0.000 {method 'bit_length' of 'int' objects}
    10000    0.008    0.000    0.025    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
   570051    0.024    0.000    0.024    0.000 {method 'append' of 'list' objects}
    10000    0.013    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.012    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    20000    0.017    0.000    0.017    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
    20000    0.014    0.000    0.014    0.000 {built-in method torch._ops.profiler.}
    10000    0.008    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20004    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
    10000    0.005    0.000    0.005    0.000 {built-in method torch.broadcast_tensors}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
    20000    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
    20000    0.004    0.000    0.004    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
30042/30038    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
    10002    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
    40002    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    10003    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
    10001    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10004    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD Pytorch. # 2
========================================================================================================================
Top 5 lines
#1: torch/_ops.py:502: 2.7 KiB
    return self._op(*args, **kwargs or {})
#2: linear/pytorch_linear_regression.py:13: 1.8 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#3: torch/functional.py:74: 1.7 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
3 other: 0.2 KiB
Total allocated size: 6.5 KiB
========================================================================================================================
TIME. PROFILING: Minibatch CD Pytorch. # 3
========================================================================================================================
         7998825 function calls (7988819 primitive calls) in 2.611 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.867    2.867 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:28(<lambda>)
        1    0.000    0.000    2.867    2.867 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:83(stochastic_grad_down)
        1    0.034    0.034    2.867    2.867 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.489    0.000    2.196    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   688495    0.115    0.000    0.757    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688495    0.323    0.000    0.642    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.395    0.000    0.395    0.000 {built-in method torch.tensor}
   688495    0.192    0.000    0.255    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10001    0.249    0.000    0.249    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
    10000    0.028    0.000    0.213    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
30000/20000    0.023    0.000    0.175    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.008    0.000    0.174    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
    10000    0.017    0.000    0.165    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
    10000    0.012    0.000    0.122    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.120    0.000    0.120    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.016    0.000    0.098    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.004    0.000    0.091    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.014    0.000    0.087    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.023    0.000    0.072    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.065    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2065485    0.064    0.000    0.064    0.000 {built-in method _operator.index}
    10000    0.009    0.000    0.048    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    20000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    10000    0.010    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.044    0.000    0.044    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.021    0.000    0.041    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
   880542    0.037    0.000    0.037    0.000 {method 'getrandbits' of '_random.Random' objects}
    20000    0.004    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    10000    0.032    0.000    0.032    0.000 {built-in method torch._C._nn.linear}
    20000    0.031    0.000    0.031    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.022    0.000    0.030    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   708501    0.028    0.000    0.028    0.000 {built-in method builtins.len}
   688495    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
   570051    0.025    0.000    0.025    0.000 {method 'append' of 'list' objects}
    10000    0.009    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
    10000    0.014    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.004    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.012    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    20000    0.016    0.000    0.016    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
    10000    0.008    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20000    0.014    0.000    0.014    0.000 {built-in method torch._ops.profiler.}
    20004    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
    10000    0.006    0.000    0.006    0.000 {built-in method torch.broadcast_tensors}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
    20000    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
    20000    0.004    0.000    0.004    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
30042/30038    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    40002    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
    10002    0.002    0.000    0.002    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    10003    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
    10001    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10004    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD Pytorch. # 3
========================================================================================================================
Top 5 lines
#1: torch/_ops.py:502: 1.8 KiB
    return self._op(*args, **kwargs or {})
#2: torch/functional.py:74: 1.0 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#3: linear/pytorch_linear_regression.py:13: 0.9 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
4 other: 0.2 KiB
Total allocated size: 4.2 KiB
========================================================================================================================
TIME. PROFILING: Minibatch CD Pytorch. # 4
========================================================================================================================
         7988894 function calls (7978888 primitive calls) in 2.589 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.845    2.845 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:28(<lambda>)
        1    0.000    0.000    2.845    2.845 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:83(stochastic_grad_down)
        1    0.033    0.033    2.845    2.845 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.485    0.000    2.179    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   687405    0.113    0.000    0.748    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687405    0.321    0.000    0.635    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.391    0.000    0.391    0.000 {built-in method torch.tensor}
    10001    0.251    0.000    0.251    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
   687405    0.190    0.000    0.250    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10000    0.028    0.000    0.207    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
    10000    0.008    0.000    0.177    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
30000/20000    0.022    0.000    0.174    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.016    0.000    0.169    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
    10000    0.125    0.000    0.125    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.011    0.000    0.119    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.015    0.000    0.095    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.004    0.000    0.091    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.013    0.000    0.087    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.023    0.000    0.071    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.065    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2062215    0.064    0.000    0.064    0.000 {built-in method _operator.index}
    10000    0.009    0.000    0.047    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    20000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    10000    0.009    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.045    0.000    0.045    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.021    0.000    0.041    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
    20000    0.004    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   879331    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    10000    0.033    0.000    0.033    0.000 {built-in method torch._C._nn.linear}
    20000    0.031    0.000    0.031    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.021    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   707411    0.028    0.000    0.028    0.000 {built-in method builtins.len}
   687405    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    10000    0.008    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
   570051    0.024    0.000    0.024    0.000 {method 'append' of 'list' objects}
    10000    0.013    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.004    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.012    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    20000    0.016    0.000    0.016    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
    20000    0.014    0.000    0.014    0.000 {built-in method torch._ops.profiler.}
    10000    0.008    0.000    0.013    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20004    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
    10000    0.005    0.000    0.005    0.000 {built-in method torch.broadcast_tensors}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
    20000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
    20000    0.003    0.000    0.003    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
30042/30038    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
    10002    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    40002    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
    10003    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
    10001    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10004    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Minibatch CD Pytorch. # 4
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 3.3 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 2.0 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 1.3 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
3 other: 0.2 KiB
Total allocated size: 7.0 KiB
========================================================================================================================
TIME. PROFILING: Momentum. # 0
========================================================================================================================
         8139528 function calls in 1.423 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.423    1.423 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:32(<lambda>)
        1    0.023    0.023    1.423    1.423 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:83(momentum_stochastic_grad_down)
    10000    0.399    0.000    1.372    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   687655    0.106    0.000    0.734    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687655    0.319    0.000    0.628    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   687655    0.188    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.092    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2062965    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1385311    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.043    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880629    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   120000    0.030    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   687655    0.024    0.000    0.024    0.000 {method 'bit_length' of 'int' objects}
    19999    0.016    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   200000    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    49999    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Momentum. # 0
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Momentum. # 1
========================================================================================================================
         8144299 function calls in 1.421 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.421    1.421 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:32(<lambda>)
        1    0.023    0.023    1.421    1.421 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:83(momentum_stochastic_grad_down)
    10000    0.395    0.000    1.370    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688104    0.106    0.000    0.737    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688104    0.320    0.000    0.630    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688104    0.188    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.092    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2064312    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1386209    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   881359    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   120000    0.030    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688104    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    19999    0.016    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   200000    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    49999    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Momentum. # 1
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Momentum. # 2
========================================================================================================================
         8136363 function calls in 1.419 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.419    1.419 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:32(<lambda>)
        1    0.023    0.023    1.419    1.419 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:83(momentum_stochastic_grad_down)
    10000    0.397    0.000    1.368    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   687440    0.106    0.000    0.733    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687440    0.319    0.000    0.627    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   687440    0.186    0.000    0.246    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2062320    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1384881    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   879399    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   120000    0.030    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   687440    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    19999    0.015    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.020    0.000    0.020    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   200000    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    49999    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Momentum. # 2
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Momentum. # 3
========================================================================================================================
         8149121 function calls in 1.427 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.427    1.427 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:32(<lambda>)
        1    0.023    0.023    1.427    1.427 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:83(momentum_stochastic_grad_down)
    10000    0.400    0.000    1.376    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688639    0.107    0.000    0.737    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688639    0.321    0.000    0.631    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688639    0.188    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.055    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2065917    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1387279    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   881366    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   120000    0.030    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688639    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    19999    0.016    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   200000    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    49999    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Momentum. # 3
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Momentum. # 4
========================================================================================================================
         8149121 function calls in 1.425 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.425    1.425 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:32(<lambda>)
        1    0.023    0.023    1.425    1.425 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:83(momentum_stochastic_grad_down)
    10000    0.400    0.000    1.374    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688627    0.107    0.000    0.736    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688627    0.321    0.000    0.629    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688627    0.187    0.000    0.247    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.055    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2065881    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1387255    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   881474    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   120000    0.030    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688627    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    19999    0.016    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   200000    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    49999    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Momentum. # 4
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Nesterov. # 0
========================================================================================================================
         8205446 function calls in 1.445 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.445    1.445 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:36(<lambda>)
        1    0.032    0.032    1.445    1.445 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:106(nesterov_stochastic_grad_down)
    10000    0.397    0.000    1.373    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688223    0.106    0.000    0.736    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688223    0.320    0.000    0.631    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688223    0.188    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2064669    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1386447    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   139999    0.034    0.000    0.039    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   881439    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    29998    0.022    0.000    0.032    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
   688223    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.011    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   219999    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    59998    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Nesterov. # 0
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
#2: lab2/linear_regression.py:34: 0.0 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: Nesterov. # 1
========================================================================================================================
         8212869 function calls in 1.453 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.453    1.453 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:36(<lambda>)
        1    0.032    0.032    1.453    1.453 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:106(nesterov_stochastic_grad_down)
    10000    0.401    0.000    1.380    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688902    0.106    0.000    0.739    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688902    0.321    0.000    0.633    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688902    0.189    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2066706    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1387805    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   139999    0.034    0.000    0.040    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   882751    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    29998    0.022    0.000    0.033    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
   688902    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.011    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   219999    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    59998    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Nesterov. # 1
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
#2: lab2/linear_regression.py:34: 0.0 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: Nesterov. # 2
========================================================================================================================
         8212455 function calls in 1.446 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.446    1.446 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:36(<lambda>)
        1    0.032    0.032    1.446    1.446 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:106(nesterov_stochastic_grad_down)
    10000    0.396    0.000    1.373    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688984    0.106    0.000    0.738    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688984    0.321    0.000    0.632    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688984    0.188    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.055    0.000    0.062    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2066952    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1387969    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   139999    0.034    0.000    0.040    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   881599    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    29998    0.022    0.000    0.032    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
   688984    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.011    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   219999    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    59998    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Nesterov. # 2
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
#2: lab2/linear_regression.py:34: 0.0 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: Nesterov. # 3
========================================================================================================================
         8204985 function calls in 1.465 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.465    1.465 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:36(<lambda>)
        1    0.033    0.033    1.465    1.465 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:106(nesterov_stochastic_grad_down)
    10000    0.400    0.000    1.391    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688164    0.107    0.000    0.747    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688164    0.325    0.000    0.639    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688164    0.191    0.000    0.252    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.038    0.000    0.095    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.064    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2064492    0.063    0.000    0.063    0.000 {built-in method _operator.index}
  1386329    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   139999    0.035    0.000    0.040    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   881509    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    29998    0.022    0.000    0.033    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
   688164    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.011    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   219999    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    59998    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Nesterov. # 3
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
#2: lab2/linear_regression.py:34: 0.0 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: Nesterov. # 4
========================================================================================================================
         8197034 function calls in 1.446 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.446    1.446 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:36(<lambda>)
        1    0.032    0.032    1.446    1.446 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:106(nesterov_stochastic_grad_down)
    10000    0.396    0.000    1.373    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   687397    0.106    0.000    0.737    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687397    0.320    0.000    0.631    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   687397    0.188    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2062191    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1384795    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   139999    0.034    0.000    0.040    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   880461    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
    29998    0.022    0.000    0.032    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
   687397    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    20000    0.005    0.000    0.011    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   219999    0.009    0.000    0.009    0.000 {built-in method builtins.isinstance}
    59998    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {built-in method numpy.zeros}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Nesterov. # 4
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
#2: lab2/linear_regression.py:34: 0.0 KiB
    return _X.transpose() * _X * b - _X.transpose() * _Y
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: Momentum Pytorch. # 0
========================================================================================================================
         3125463 function calls (3121565 primitive calls) in 1.035 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.134    1.134 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:40(<lambda>)
        1    0.000    0.000    1.134    1.134 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:93(momentum_stochastic_grad_down)
        1    0.013    0.013    1.134    1.134 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
     3893    0.189    0.000    0.849    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   267575    0.042    0.000    0.290    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   267575    0.126    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
     7788    0.153    0.000    0.153    0.000 {built-in method torch.tensor}
     3892    0.011    0.000    0.106    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   267575    0.075    0.000    0.098    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
     3893    0.097    0.000    0.097    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
     3892    0.005    0.000    0.071    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
     3892    0.003    0.000    0.069    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
11676/7784    0.009    0.000    0.069    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
     3892    0.006    0.000    0.066    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
     3892    0.006    0.000    0.061    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
     3892    0.048    0.000    0.048    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
     3892    0.003    0.000    0.042    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
     3892    0.001    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
     3892    0.005    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
     3892    0.006    0.000    0.033    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
     3892    0.009    0.000    0.028    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
     3892    0.003    0.000    0.026    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
   802725    0.025    0.000    0.025    0.000 {built-in method _operator.index}
     7784    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
     3892    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
     3892    0.018    0.000    0.018    0.000 {built-in method torch._C._nn.mse_loss}
     7784    0.008    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
     7782    0.016    0.000    0.016    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
     7784    0.002    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   342360    0.014    0.000    0.014    0.000 {method 'getrandbits' of '_random.Random' objects}
     3892    0.013    0.000    0.013    0.000 {built-in method torch._C._nn.linear}
     7784    0.012    0.000    0.012    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
     3892    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   275365    0.011    0.000    0.011    0.000 {built-in method builtins.len}
    15566    0.011    0.000    0.011    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   267575    0.010    0.000    0.010    0.000 {method 'bit_length' of 'int' objects}
   221895    0.009    0.000    0.009    0.000 {method 'append' of 'list' objects}
     3892    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
     3892    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
     7784    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
     7784    0.005    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
     7784    0.005    0.000    0.005    0.000 {built-in method torch._ops.profiler.}
     3892    0.003    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
     7788    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    15578    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
     3892    0.003    0.000    0.003    0.000 {built-in method torch.ones_like}
    11690    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
     3892    0.002    0.000    0.002    0.000 {built-in method torch.broadcast_tensors}
    11681    0.002    0.000    0.002    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    11676    0.002    0.000    0.002    0.000 {built-in method torch._C._get_tracing_state}
     3892    0.001    0.000    0.002    0.000 {built-in method builtins.all}
     3892    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
     7784    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
     7784    0.001    0.000    0.001    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
11718/11714    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
    15578    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     3894    0.001    0.000    0.001    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    15570    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    11682    0.001    0.000    0.001    0.000 {built-in method torch.is_grad_enabled}
    15573    0.001    0.000    0.001    0.000 {method 'values' of 'collections.OrderedDict' objects}
     3895    0.001    0.000    0.001    0.000 {method 'format' of 'str' objects}
     7784    0.001    0.000    0.001    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
     3892    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
     7788    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
     3892    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
     3892    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
     7784    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
     3892    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
     3894    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
     3892    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
     3893    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
     3896    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     3892    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
     3909    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     3892    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Momentum Pytorch. # 0
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 2.2 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 1.0 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.7 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/sgd.py:47: 0.1 KiB
    state = self.state[p]
#5: modules/module.py:1626: 0.1 KiB
    params = self.__dict__.get('_parameters')
11 other: 0.8 KiB
Total allocated size: 5.1 KiB
========================================================================================================================
TIME. PROFILING: Momentum Pytorch. # 1
========================================================================================================================
         3156598 function calls (3152668 primitive calls) in 1.046 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.146    1.146 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:40(<lambda>)
        1    0.000    0.000    1.146    1.146 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:93(momentum_stochastic_grad_down)
        1    0.013    0.013    1.146    1.146 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
     3925    0.192    0.000    0.859    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   270341    0.042    0.000    0.293    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   270341    0.127    0.000    0.251    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
     7852    0.155    0.000    0.155    0.000 {built-in method torch.tensor}
     3924    0.011    0.000    0.106    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   270341    0.075    0.000    0.099    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
     3925    0.098    0.000    0.098    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
     3924    0.005    0.000    0.070    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
     3924    0.003    0.000    0.070    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
11772/7848    0.009    0.000    0.069    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
     3924    0.006    0.000    0.066    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
     3924    0.006    0.000    0.060    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
     3924    0.049    0.000    0.049    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
     3924    0.003    0.000    0.041    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
     3924    0.001    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
     3924    0.005    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
     3924    0.006    0.000    0.032    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
     3924    0.009    0.000    0.028    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
     3924    0.003    0.000    0.026    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
   811023    0.025    0.000    0.025    0.000 {built-in method _operator.index}
     7848    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
     3924    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
     3924    0.018    0.000    0.018    0.000 {built-in method torch._C._nn.mse_loss}
     7848    0.008    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
     7846    0.016    0.000    0.016    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
     7848    0.002    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   346087    0.014    0.000    0.014    0.000 {method 'getrandbits' of '_random.Random' objects}
     3924    0.013    0.000    0.013    0.000 {built-in method torch._C._nn.linear}
     7848    0.013    0.000    0.013    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
     3924    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   278195    0.011    0.000    0.011    0.000 {built-in method builtins.len}
    15694    0.011    0.000    0.011    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   270341    0.010    0.000    0.010    0.000 {method 'bit_length' of 'int' objects}
   223719    0.010    0.000    0.010    0.000 {method 'append' of 'list' objects}
     3924    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
     3924    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
     7848    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
     7848    0.005    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
     7848    0.006    0.000    0.006    0.000 {built-in method torch._ops.profiler.}
     3924    0.003    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
     7852    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    15706    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
     3924    0.003    0.000    0.003    0.000 {built-in method torch.ones_like}
    11786    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
     3924    0.002    0.000    0.002    0.000 {built-in method torch.broadcast_tensors}
    11772    0.002    0.000    0.002    0.000 {built-in method torch._C._get_tracing_state}
    11777    0.002    0.000    0.002    0.000 {method 'size' of 'torch._C._TensorBase' objects}
     3924    0.001    0.000    0.002    0.000 {built-in method builtins.all}
     3924    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
     7848    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
     7848    0.001    0.000    0.001    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
11814/11810    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
    15706    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     3926    0.001    0.000    0.001    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    11778    0.001    0.000    0.001    0.000 {built-in method torch.is_grad_enabled}
    15701    0.001    0.000    0.001    0.000 {method 'values' of 'collections.OrderedDict' objects}
    15698    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
     3927    0.001    0.000    0.001    0.000 {method 'format' of 'str' objects}
     7848    0.001    0.000    0.001    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
     7852    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
     3924    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
     3924    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
     3924    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
     7848    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
     3924    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
     3926    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
     3924    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
     3925    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
     3924    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
     3928    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     3941    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     3924    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Momentum Pytorch. # 1
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 3.0 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.9 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.5 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
3 other: 0.2 KiB
Total allocated size: 4.8 KiB
========================================================================================================================
TIME. PROFILING: Momentum Pytorch. # 2
========================================================================================================================
         3144138 function calls (3140218 primitive calls) in 1.040 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.140    1.140 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:40(<lambda>)
        1    0.000    0.000    1.140    1.140 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:93(momentum_stochastic_grad_down)
        1    0.013    0.013    1.140    1.140 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
     3915    0.191    0.000    0.854    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   269223    0.042    0.000    0.293    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   269223    0.127    0.000    0.251    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
     7832    0.154    0.000    0.154    0.000 {built-in method torch.tensor}
     3914    0.011    0.000    0.105    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   269223    0.075    0.000    0.099    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
     3915    0.097    0.000    0.097    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
     3914    0.003    0.000    0.070    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
     3914    0.005    0.000    0.069    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
11742/7828    0.009    0.000    0.069    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
     3914    0.006    0.000    0.066    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
     3914    0.006    0.000    0.060    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
     3914    0.049    0.000    0.049    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
     3914    0.003    0.000    0.041    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
     3914    0.001    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
     3914    0.005    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
     3914    0.006    0.000    0.032    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
     3914    0.009    0.000    0.028    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
     3914    0.003    0.000    0.026    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
   807669    0.025    0.000    0.025    0.000 {built-in method _operator.index}
     7828    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
     3914    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
     3914    0.018    0.000    0.018    0.000 {built-in method torch._C._nn.mse_loss}
     7828    0.008    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
     7826    0.015    0.000    0.015    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
     7828    0.002    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   344221    0.014    0.000    0.014    0.000 {method 'getrandbits' of '_random.Random' objects}
     3914    0.013    0.000    0.013    0.000 {built-in method torch._C._nn.linear}
     7828    0.012    0.000    0.012    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
     3914    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   277057    0.011    0.000    0.011    0.000 {built-in method builtins.len}
    15654    0.011    0.000    0.011    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   269223    0.010    0.000    0.010    0.000 {method 'bit_length' of 'int' objects}
   223149    0.010    0.000    0.010    0.000 {method 'append' of 'list' objects}
     3914    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
     3914    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
     7828    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
     7828    0.005    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
     7828    0.005    0.000    0.005    0.000 {built-in method torch._ops.profiler.}
     3914    0.003    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
     7832    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    15666    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
     3914    0.003    0.000    0.003    0.000 {built-in method torch.ones_like}
    11756    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
     3914    0.002    0.000    0.002    0.000 {built-in method torch.broadcast_tensors}
    11747    0.002    0.000    0.002    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    11742    0.002    0.000    0.002    0.000 {built-in method torch._C._get_tracing_state}
     3914    0.001    0.000    0.002    0.000 {built-in method builtins.all}
     3914    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
     7828    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
     7828    0.001    0.000    0.001    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
11784/11780    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
    15666    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     3916    0.001    0.000    0.001    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    15658    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    11748    0.001    0.000    0.001    0.000 {built-in method torch.is_grad_enabled}
    15661    0.001    0.000    0.001    0.000 {method 'values' of 'collections.OrderedDict' objects}
     3917    0.001    0.000    0.001    0.000 {method 'format' of 'str' objects}
     7828    0.001    0.000    0.001    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
     3914    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
     3914    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
     7832    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
     3914    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
     7828    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
     3914    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
     3916    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
     3914    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
     3915    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
     3914    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
     3918    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     3931    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     3914    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Momentum Pytorch. # 2
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 2.6 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.9 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.7 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
3 other: 0.2 KiB
Total allocated size: 4.7 KiB
========================================================================================================================
TIME. PROFILING: Momentum Pytorch. # 3
========================================================================================================================
         3155662 function calls (3151723 primitive calls) in 1.040 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.140    1.140 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:40(<lambda>)
        1    0.000    0.000    1.140    1.140 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:93(momentum_stochastic_grad_down)
        1    0.013    0.013    1.140    1.140 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
     3934    0.190    0.000    0.856    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   270091    0.042    0.000    0.293    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   270091    0.127    0.000    0.251    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
     7870    0.155    0.000    0.155    0.000 {built-in method torch.tensor}
     3933    0.011    0.000    0.105    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   270091    0.075    0.000    0.099    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
     3934    0.098    0.000    0.098    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
     3933    0.005    0.000    0.069    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
     3933    0.003    0.000    0.069    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
11799/7866    0.009    0.000    0.069    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
     3933    0.006    0.000    0.065    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
     3933    0.006    0.000    0.060    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
     3933    0.048    0.000    0.048    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
     3933    0.003    0.000    0.041    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
     3933    0.001    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
     3933    0.005    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
     3933    0.006    0.000    0.032    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
     3933    0.009    0.000    0.028    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
     3933    0.003    0.000    0.026    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
   810273    0.025    0.000    0.025    0.000 {built-in method _operator.index}
     7866    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
     3933    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
     3933    0.017    0.000    0.017    0.000 {built-in method torch._C._nn.mse_loss}
     7866    0.008    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
     7864    0.015    0.000    0.015    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
     7866    0.002    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   345666    0.014    0.000    0.014    0.000 {method 'getrandbits' of '_random.Random' objects}
     3933    0.013    0.000    0.013    0.000 {built-in method torch._C._nn.linear}
     7866    0.012    0.000    0.012    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
     3933    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   277963    0.011    0.000    0.011    0.000 {built-in method builtins.len}
    15730    0.011    0.000    0.011    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   270091    0.010    0.000    0.010    0.000 {method 'bit_length' of 'int' objects}
   224232    0.010    0.000    0.010    0.000 {method 'append' of 'list' objects}
     3933    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
     3933    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
     7866    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
     7866    0.005    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
     7866    0.005    0.000    0.005    0.000 {built-in method torch._ops.profiler.}
     3933    0.003    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
     7870    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    15742    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
     3933    0.003    0.000    0.003    0.000 {built-in method torch.ones_like}
    11813    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
     3933    0.002    0.000    0.002    0.000 {built-in method torch.broadcast_tensors}
    11804    0.002    0.000    0.002    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    11799    0.002    0.000    0.002    0.000 {built-in method torch._C._get_tracing_state}
     3933    0.001    0.000    0.002    0.000 {built-in method builtins.all}
     3933    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
     7866    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
     7866    0.001    0.000    0.001    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
11841/11837    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
    15742    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     3935    0.001    0.000    0.001    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    15734    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    15737    0.001    0.000    0.001    0.000 {method 'values' of 'collections.OrderedDict' objects}
    11805    0.001    0.000    0.001    0.000 {built-in method torch.is_grad_enabled}
     3936    0.001    0.000    0.001    0.000 {method 'format' of 'str' objects}
     7866    0.001    0.000    0.001    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
     3933    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
     3933    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
     7870    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
     3933    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
     7866    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
     3933    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
     3935    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
     3933    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
     3934    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
     3933    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
     3937    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     3950    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     3933    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Momentum Pytorch. # 3
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 2.3 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/functional.py:74: 1.0 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#3: torch/_ops.py:502: 0.9 KiB
    return self._op(*args, **kwargs or {})
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
4 other: 0.2 KiB
Total allocated size: 4.6 KiB
========================================================================================================================
TIME. PROFILING: Momentum Pytorch. # 4
========================================================================================================================
         3146050 function calls (3142128 primitive calls) in 1.035 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.134    1.134 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:40(<lambda>)
        1    0.000    0.000    1.134    1.134 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:93(momentum_stochastic_grad_down)
        1    0.013    0.013    1.134    1.134 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
     3917    0.191    0.000    0.854    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   269374    0.042    0.000    0.294    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   269374    0.127    0.000    0.252    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
     7836    0.154    0.000    0.154    0.000 {built-in method torch.tensor}
     3916    0.011    0.000    0.103    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   269374    0.076    0.000    0.099    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
     3917    0.097    0.000    0.097    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
     3916    0.005    0.000    0.068    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
11748/7832    0.009    0.000    0.067    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
     3916    0.003    0.000    0.067    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
     3916    0.006    0.000    0.064    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
     3916    0.006    0.000    0.059    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
     3916    0.046    0.000    0.046    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
     3916    0.003    0.000    0.040    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
     3916    0.001    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
     3916    0.005    0.000    0.034    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
     3916    0.006    0.000    0.031    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
     3916    0.009    0.000    0.028    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
     3916    0.003    0.000    0.025    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
   808122    0.025    0.000    0.025    0.000 {built-in method _operator.index}
     7832    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
     3916    0.004    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
     3916    0.017    0.000    0.017    0.000 {built-in method torch._C._nn.mse_loss}
     7832    0.008    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
     7830    0.015    0.000    0.015    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
     7832    0.002    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   344595    0.014    0.000    0.014    0.000 {method 'getrandbits' of '_random.Random' objects}
     7832    0.012    0.000    0.012    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
     3916    0.012    0.000    0.012    0.000 {built-in method torch._C._nn.linear}
     3916    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   277212    0.011    0.000    0.011    0.000 {built-in method builtins.len}
    15662    0.010    0.000    0.010    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   269374    0.010    0.000    0.010    0.000 {method 'bit_length' of 'int' objects}
   223263    0.010    0.000    0.010    0.000 {method 'append' of 'list' objects}
     3916    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
     3916    0.005    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
     7832    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
     7832    0.005    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
     3916    0.003    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
     7832    0.005    0.000    0.005    0.000 {built-in method torch._ops.profiler.}
     7836    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    15674    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    11762    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
     3916    0.003    0.000    0.003    0.000 {built-in method torch.ones_like}
     3916    0.002    0.000    0.002    0.000 {built-in method torch.broadcast_tensors}
    11748    0.002    0.000    0.002    0.000 {built-in method torch._C._get_tracing_state}
    11753    0.002    0.000    0.002    0.000 {method 'size' of 'torch._C._TensorBase' objects}
     3916    0.001    0.000    0.002    0.000 {built-in method builtins.all}
     3916    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
     7832    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
     7832    0.001    0.000    0.001    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
11790/11786    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
    15674    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     3918    0.001    0.000    0.001    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    15666    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    15669    0.001    0.000    0.001    0.000 {method 'values' of 'collections.OrderedDict' objects}
    11754    0.001    0.000    0.001    0.000 {built-in method torch.is_grad_enabled}
     3919    0.001    0.000    0.001    0.000 {method 'format' of 'str' objects}
     7832    0.001    0.000    0.001    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
     7836    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
     3916    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
     3916    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
     3916    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
     7832    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
     3916    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
     3918    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
     3916    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
     3917    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
     3916    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
     3920    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     3933    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     3916    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Momentum Pytorch. # 4
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 2.1 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/functional.py:74: 1.2 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#3: torch/_ops.py:502: 1.0 KiB
    return self._op(*args, **kwargs or {})
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
3 other: 0.2 KiB
Total allocated size: 4.7 KiB
========================================================================================================================
TIME. PROFILING: Nesterov Pytorch. # 0
========================================================================================================================
         8065077 function calls (8055071 primitive calls) in 2.680 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.935    2.935 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:44(<lambda>)
        1    0.000    0.000    2.935    2.935 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:103(nesterov_stochastic_grad_down)
        1    0.033    0.033    2.935    2.935 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.487    0.000    2.184    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   689111    0.107    0.000    0.749    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   689111    0.326    0.000    0.642    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.394    0.000    0.394    0.000 {built-in method torch.tensor}
    10000    0.028    0.000    0.293    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   689111    0.192    0.000    0.253    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10001    0.249    0.000    0.249    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
    10000    0.012    0.000    0.203    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.016    0.000    0.178    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.008    0.000    0.175    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
30000/20000    0.022    0.000    0.175    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.016    0.000    0.167    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
    10000    0.011    0.000    0.129    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    10000    0.122    0.000    0.122    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.021    0.000    0.104    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
    10000    0.004    0.000    0.092    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.014    0.000    0.088    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.023    0.000    0.072    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.065    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2067333    0.064    0.000    0.064    0.000 {built-in method _operator.index}
    20000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    10000    0.009    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.044    0.000    0.044    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.021    0.000    0.042    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
    19998    0.039    0.000    0.039    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
    20000    0.004    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   881866    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    10000    0.032    0.000    0.032    0.000 {built-in method torch._C._nn.linear}
    20000    0.032    0.000    0.032    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.021    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   709117    0.028    0.000    0.028    0.000 {built-in method builtins.len}
    39998    0.027    0.000    0.027    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   689111    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
   570051    0.024    0.000    0.024    0.000 {method 'append' of 'list' objects}
    10000    0.013    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.018    0.000    0.018    0.000 {method 'add' of 'torch._C._TensorBase' objects}
    20000    0.004    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.012    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    10000    0.008    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20000    0.014    0.000    0.014    0.000 {built-in method torch._ops.profiler.}
    20004    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
    10000    0.006    0.000    0.006    0.000 {built-in method torch.broadcast_tensors}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
    20000    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
    20000    0.004    0.000    0.004    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
30042/30038    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    10002    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    40002    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    10003    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
    10001    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10004    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Nesterov Pytorch. # 0
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 2.4 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 1.4 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 1.1 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/sgd.py:47: 0.1 KiB
    state = self.state[p]
#5: modules/module.py:1626: 0.1 KiB
    params = self.__dict__.get('_parameters')
12 other: 0.9 KiB
Total allocated size: 6.1 KiB
========================================================================================================================
TIME. PROFILING: Nesterov Pytorch. # 1
========================================================================================================================
         8052477 function calls (8042471 primitive calls) in 2.682 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.938    2.938 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:44(<lambda>)
        1    0.000    0.000    2.938    2.938 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:103(nesterov_stochastic_grad_down)
        1    0.033    0.033    2.937    2.937 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.489    0.000    2.185    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   687683    0.107    0.000    0.748    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687683    0.324    0.000    0.641    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.394    0.000    0.394    0.000 {built-in method torch.tensor}
    10000    0.028    0.000    0.292    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   687683    0.191    0.000    0.253    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10001    0.249    0.000    0.249    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
    10000    0.012    0.000    0.202    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.015    0.000    0.178    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.008    0.000    0.177    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
30000/20000    0.022    0.000    0.175    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.016    0.000    0.168    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
    10000    0.011    0.000    0.129    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    10000    0.124    0.000    0.124    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.021    0.000    0.104    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
    10000    0.004    0.000    0.092    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.014    0.000    0.088    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.023    0.000    0.072    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.065    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2063049    0.064    0.000    0.064    0.000 {built-in method _operator.index}
    20000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    10000    0.009    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.045    0.000    0.045    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.021    0.000    0.042    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
    19998    0.040    0.000    0.040    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
    20000    0.004    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   880690    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    10000    0.033    0.000    0.033    0.000 {built-in method torch._C._nn.linear}
    20000    0.032    0.000    0.032    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.021    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   707689    0.028    0.000    0.028    0.000 {built-in method builtins.len}
    39998    0.027    0.000    0.027    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   687683    0.027    0.000    0.027    0.000 {method 'bit_length' of 'int' objects}
   570051    0.024    0.000    0.024    0.000 {method 'append' of 'list' objects}
    10000    0.013    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.017    0.000    0.017    0.000 {method 'add' of 'torch._C._TensorBase' objects}
    20000    0.012    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    20000    0.014    0.000    0.014    0.000 {built-in method torch._ops.profiler.}
    10000    0.008    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20004    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
    10000    0.006    0.000    0.006    0.000 {built-in method torch.broadcast_tensors}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
    20000    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
    20000    0.004    0.000    0.004    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
30042/30038    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
    10002    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    40002    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    10003    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
    10001    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10004    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Nesterov Pytorch. # 1
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 2.5 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 2.2 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 1.2 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
4 other: 0.2 KiB
Total allocated size: 6.3 KiB
========================================================================================================================
TIME. PROFILING: Nesterov Pytorch. # 2
========================================================================================================================
         8060031 function calls (8050025 primitive calls) in 2.686 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.942    2.942 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:44(<lambda>)
        1    0.000    0.000    2.942    2.942 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:103(nesterov_stochastic_grad_down)
        1    0.033    0.033    2.942    2.942 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.488    0.000    2.187    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   688551    0.107    0.000    0.750    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688551    0.325    0.000    0.642    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.394    0.000    0.394    0.000 {built-in method torch.tensor}
    10000    0.028    0.000    0.292    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   688551    0.192    0.000    0.253    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10001    0.250    0.000    0.250    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
    10000    0.012    0.000    0.202    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.016    0.000    0.178    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.008    0.000    0.178    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
30000/20000    0.022    0.000    0.177    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.016    0.000    0.169    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
    10000    0.011    0.000    0.128    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    10000    0.125    0.000    0.125    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.021    0.000    0.103    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
    10000    0.004    0.000    0.092    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.014    0.000    0.089    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.023    0.000    0.072    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.066    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2065653    0.064    0.000    0.064    0.000 {built-in method _operator.index}
    20000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    10000    0.009    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.045    0.000    0.045    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.021    0.000    0.042    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
    19998    0.039    0.000    0.039    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
    20000    0.004    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   881300    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    10000    0.033    0.000    0.033    0.000 {built-in method torch._C._nn.linear}
    20000    0.032    0.000    0.032    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.022    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   708557    0.028    0.000    0.028    0.000 {built-in method builtins.len}
    39998    0.027    0.000    0.027    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   688551    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
   570051    0.025    0.000    0.025    0.000 {method 'append' of 'list' objects}
    10000    0.013    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.017    0.000    0.017    0.000 {method 'add' of 'torch._C._TensorBase' objects}
    20000    0.012    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    20000    0.014    0.000    0.014    0.000 {built-in method torch._ops.profiler.}
    10000    0.008    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20004    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
    10000    0.006    0.000    0.006    0.000 {built-in method torch.broadcast_tensors}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
    20000    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
    20000    0.004    0.000    0.004    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
30042/30038    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
    10002    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    40002    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
    10003    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10001    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10004    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Nesterov Pytorch. # 2
========================================================================================================================
Top 5 lines
#1: torch/_ops.py:502: 2.5 KiB
    return self._op(*args, **kwargs or {})
#2: linear/pytorch_linear_regression.py:13: 2.1 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#3: torch/functional.py:74: 1.3 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
3 other: 0.2 KiB
Total allocated size: 6.4 KiB
========================================================================================================================
TIME. PROFILING: Nesterov Pytorch. # 3
========================================================================================================================
         8041869 function calls (8031863 primitive calls) in 2.676 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.931    2.931 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:44(<lambda>)
        1    0.000    0.000    2.931    2.931 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:103(nesterov_stochastic_grad_down)
        1    0.033    0.033    2.931    2.931 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.488    0.000    2.181    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   686662    0.107    0.000    0.745    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   686662    0.322    0.000    0.638    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.393    0.000    0.393    0.000 {built-in method torch.tensor}
    10000    0.028    0.000    0.292    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   686662    0.191    0.000    0.252    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10001    0.249    0.000    0.249    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
    10000    0.012    0.000    0.202    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.015    0.000    0.178    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.008    0.000    0.176    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
30000/20000    0.022    0.000    0.174    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.016    0.000    0.167    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
    10000    0.011    0.000    0.129    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    10000    0.123    0.000    0.123    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.021    0.000    0.104    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
    10000    0.004    0.000    0.091    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.013    0.000    0.087    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.023    0.000    0.072    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.065    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2059986    0.064    0.000    0.064    0.000 {built-in method _operator.index}
    20000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    10000    0.009    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.044    0.000    0.044    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.021    0.000    0.042    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
    19998    0.039    0.000    0.039    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
    20000    0.004    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   878250    0.035    0.000    0.035    0.000 {method 'getrandbits' of '_random.Random' objects}
    10000    0.032    0.000    0.032    0.000 {built-in method torch._C._nn.linear}
    20000    0.032    0.000    0.032    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.021    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   706668    0.028    0.000    0.028    0.000 {built-in method builtins.len}
    39998    0.027    0.000    0.027    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   686662    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
   570051    0.024    0.000    0.024    0.000 {method 'append' of 'list' objects}
    10000    0.013    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.017    0.000    0.017    0.000 {method 'add' of 'torch._C._TensorBase' objects}
    20000    0.012    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    20000    0.014    0.000    0.014    0.000 {built-in method torch._ops.profiler.}
    10000    0.008    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20004    0.008    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
    10000    0.006    0.000    0.006    0.000 {built-in method torch.broadcast_tensors}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
    20000    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
    20000    0.004    0.000    0.004    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
30042/30038    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
    10002    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    40002    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
    10003    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
    10001    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10004    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Nesterov Pytorch. # 3
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 1.8 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.6 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.5 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
4 other: 0.2 KiB
Total allocated size: 3.4 KiB
========================================================================================================================
TIME. PROFILING: Nesterov Pytorch. # 4
========================================================================================================================
         8057453 function calls (8047447 primitive calls) in 2.686 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    2.943    2.943 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:44(<lambda>)
        1    0.000    0.000    2.943    2.943 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:103(nesterov_stochastic_grad_down)
        1    0.033    0.033    2.943    2.943 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
    10001    0.488    0.000    2.186    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
   688314    0.108    0.000    0.748    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688314    0.323    0.000    0.640    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
    20004    0.394    0.000    0.394    0.000 {built-in method torch.tensor}
    10000    0.029    0.000    0.294    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
   688314    0.192    0.000    0.253    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    10001    0.250    0.000    0.250    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
    10000    0.012    0.000    0.203    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    10000    0.015    0.000    0.179    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:56(step)
    10000    0.008    0.000    0.179    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
30000/20000    0.022    0.000    0.176    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
    10000    0.016    0.000    0.170    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
    10000    0.011    0.000    0.130    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:187(sgd)
    10000    0.126    0.000    0.126    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
    10000    0.021    0.000    0.105    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:233(_single_tensor_sgd)
    10000    0.004    0.000    0.092    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
    10000    0.013    0.000    0.088    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
    10000    0.023    0.000    0.072    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    10000    0.007    0.000    0.066    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
  2064942    0.064    0.000    0.064    0.000 {built-in method _operator.index}
    20000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
    10000    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
    10000    0.045    0.000    0.045    0.000 {built-in method torch._C._nn.mse_loss}
    20000    0.021    0.000    0.042    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
    19998    0.040    0.000    0.040    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
    20000    0.004    0.000    0.036    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
   880618    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    10000    0.033    0.000    0.033    0.000 {built-in method torch._C._nn.linear}
    20000    0.032    0.000    0.032    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    10000    0.021    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:37(_init_group)
   708320    0.028    0.000    0.028    0.000 {built-in method builtins.len}
    39998    0.027    0.000    0.027    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
   688314    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
   570051    0.024    0.000    0.024    0.000 {method 'append' of 'list' objects}
    10000    0.013    0.000    0.024    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    10000    0.012    0.000    0.023    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    20000    0.004    0.000    0.018    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
    20000    0.017    0.000    0.017    0.000 {method 'add' of 'torch._C._TensorBase' objects}
    20000    0.012    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
    20000    0.014    0.000    0.014    0.000 {built-in method torch._ops.profiler.}
    10000    0.008    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
    20004    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
    40010    0.007    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
    10000    0.008    0.000    0.008    0.000 {built-in method torch.ones_like}
    30014    0.008    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
    10000    0.006    0.000    0.006    0.000 {built-in method torch.broadcast_tensors}
    30005    0.005    0.000    0.005    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    30000    0.005    0.000    0.005    0.000 {built-in method torch._C._get_tracing_state}
    10000    0.002    0.000    0.005    0.000 {built-in method builtins.all}
    10000    0.003    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
    20000    0.004    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
    20000    0.004    0.000    0.004    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
30042/30038    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}
    40010    0.003    0.000    0.003    0.000 {built-in method builtins.id}
    10002    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    30006    0.002    0.000    0.002    0.000 {built-in method torch.is_grad_enabled}
    40002    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
    40005    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
    10003    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
    20000    0.002    0.000    0.002    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
    20004    0.002    0.000    0.002    0.000 {built-in method torch._C._set_grad_enabled}
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
    10000    0.002    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._are_functorch_transforms_active}
    20000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
    10000    0.001    0.000    0.001    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    10002    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function}
    10001    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
    10000    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
    10004    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    10017    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/sgd.py:11(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.clone}
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Nesterov Pytorch. # 4
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 1.6 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.7 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.6 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
3 other: 0.2 KiB
Total allocated size: 3.3 KiB
========================================================================================================================
TIME. PROFILING: Adagrad. # 0
========================================================================================================================
         8151740 function calls in 1.462 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.462    1.462 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:48(<lambda>)
        1    0.052    0.052    1.462    1.462 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:129(adagrad_stochastic_grad_down)
    10000    0.400    0.000    1.379    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   687886    0.106    0.000    0.737    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687886    0.321    0.000    0.631    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   687886    0.187    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.064    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2063658    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1395773    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880758    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   100001    0.025    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   687886    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   180001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adagrad. # 0
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Adagrad. # 1
========================================================================================================================
         8156443 function calls in 1.459 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.459    1.459 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:48(<lambda>)
        1    0.052    0.052    1.459    1.459 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:129(adagrad_stochastic_grad_down)
    10000    0.397    0.000    1.377    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688419    0.106    0.000    0.738    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688419    0.322    0.000    0.632    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688419    0.188    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.064    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2065257    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1396839    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880664    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   100001    0.025    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688419    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   180001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adagrad. # 1
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Adagrad. # 2
========================================================================================================================
         8152136 function calls in 1.460 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.460    1.460 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:48(<lambda>)
        1    0.052    0.052    1.460    1.460 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:129(adagrad_stochastic_grad_down)
    10000    0.397    0.000    1.378    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688022    0.106    0.000    0.739    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688022    0.323    0.000    0.632    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688022    0.187    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.094    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.064    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2064066    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1396045    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   879930    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   100001    0.025    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688022    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   180001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adagrad. # 2
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Adagrad. # 3
========================================================================================================================
         8152620 function calls in 1.451 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.451    1.451 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:48(<lambda>)
        1    0.052    0.052    1.451    1.451 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:129(adagrad_stochastic_grad_down)
    10000    0.394    0.000    1.369    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   687982    0.106    0.000    0.735    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687982    0.320    0.000    0.629    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   687982    0.187    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.036    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2063946    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1395965    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880774    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   100001    0.025    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   687982    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   180001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adagrad. # 3
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Adagrad. # 4
========================================================================================================================
         8162324 function calls in 1.461 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.461    1.461 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:48(<lambda>)
        1    0.052    0.052    1.461    1.461 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:129(adagrad_stochastic_grad_down)
    10000    0.397    0.000    1.378    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688965    0.106    0.000    0.740    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688965    0.323    0.000    0.634    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688965    0.188    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.094    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2066895    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1397931    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   881631    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   100001    0.025    0.000    0.029    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688965    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   180001    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adagrad. # 4
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.1 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Adagrad Pytorch. # 0
========================================================================================================================
         152875 function calls (152684 primitive calls) in 0.054 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.059    0.059 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:52(<lambda>)
        1    0.000    0.000    0.059    0.059 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:113(adagrad_stochastic_grad_down)
        1    0.001    0.001    0.058    0.058 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      186    0.009    0.000    0.041    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    12840    0.002    0.000    0.014    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    12840    0.006    0.000    0.012    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      185    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      376    0.007    0.000    0.007    0.000 {built-in method torch.tensor}
      185    0.000    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      185    0.000    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:101(step)
      185    0.000    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:185(adagrad)
    12840    0.004    0.000    0.005    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      185    0.001    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:245(_single_tensor_adagrad)
      186    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      185    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
  555/370    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      185    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      185    0.002    0.000    0.002    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      185    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      185    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      185    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      185    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    38520    0.001    0.000    0.001    0.000 {built-in method _operator.index}
        1    0.000    0.000    0.001    0.001 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:13(__init__)
      372    0.001    0.000    0.001    0.000 {built-in method torch.is_complex}
      370    0.001    0.000    0.001    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      370    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      185    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      370    0.001    0.000    0.001    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      185    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      370    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      370    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    16506    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      370    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
      370    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      185    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      185    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:87(_init_group)
    13216    0.001    0.000    0.001    0.000 {built-in method builtins.len}
      370    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
    10966    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
    12840    0.000    0.000    0.000    0.000 {method 'bit_length' of 'int' objects}
      185    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      185    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      370    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      370    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      370    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      370    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      370    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      185    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      374    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      185    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      569    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
      557    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      185    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      555    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:207(<genexpr>)
      382    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      560    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      555    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
  967/963    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      188    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      185    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.full_like}
      370    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      370    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      927    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      745    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      561    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      185    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      374    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      185    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      370    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      382    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      189    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      185    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      370    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
      370    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
      185    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
      193    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      185    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
      187    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
      185    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
      202    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:262(profile_hook_step)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
      185    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:35(update_wrapper)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:65(wraps)
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Adagrad Pytorch. # 0
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 1.7 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.5 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.4 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/adagrad.py:56: 0.1 KiB
    state["step"] = torch.tensor(0.0)
#5: optim/adagrad.py:55: 0.1 KiB
    state = self.state[p]
13 other: 1.0 KiB
Total allocated size: 3.9 KiB
========================================================================================================================
TIME. PROFILING: Adagrad Pytorch. # 1
========================================================================================================================
         173970 function calls (173753 primitive calls) in 0.058 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.063    0.063 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:52(<lambda>)
        1    0.000    0.000    0.063    0.063 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:113(adagrad_stochastic_grad_down)
        1    0.001    0.001    0.063    0.063 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      212    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    14612    0.002    0.000    0.016    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    14612    0.007    0.000    0.014    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      428    0.008    0.000    0.008    0.000 {built-in method torch.tensor}
      211    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      211    0.000    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    14612    0.004    0.000    0.005    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      212    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      211    0.000    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:101(step)
      211    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:185(adagrad)
  633/422    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      211    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
      211    0.001    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:245(_single_tensor_adagrad)
      211    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      211    0.003    0.000    0.003    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      211    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      211    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      211    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    43836    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      211    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
      422    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      211    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      211    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      422    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      422    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    18761    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      422    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      211    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:87(_init_group)
      422    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
      211    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
    15040    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    14612    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
    12500    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      211    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      422    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      422    0.000    0.000    0.000    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      422    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      422    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      422    0.000    0.000    0.000    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      426    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      647    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      211    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      635    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      633    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:207(<genexpr>)
      211    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      434    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      638    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      633    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
1097/1093    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
      422    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      424    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
     1057    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      849    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      639    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      214    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:13(__init__)
      422    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      426    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      434    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      211    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
      211    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      215    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      213    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      211    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      212    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      211    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
      228    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.full_like}
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adagrad Pytorch. # 1
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 4.6 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 2.1 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.8 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/adagrad.py:56: 0.1 KiB
    state["step"] = torch.tensor(0.0)
#5: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
5 other: 0.4 KiB
Total allocated size: 8.1 KiB
========================================================================================================================
TIME. PROFILING: Adagrad Pytorch. # 2
========================================================================================================================
         174245 function calls (174027 primitive calls) in 0.062 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.068    0.068 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:52(<lambda>)
        1    0.000    0.000    0.068    0.068 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:113(adagrad_stochastic_grad_down)
        1    0.001    0.001    0.068    0.068 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      213    0.011    0.000    0.049    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    14619    0.002    0.000    0.017    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    14619    0.007    0.000    0.014    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      430    0.009    0.000    0.009    0.000 {built-in method torch.tensor}
      212    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      212    0.000    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    14619    0.004    0.000    0.006    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      212    0.000    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:101(step)
      213    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      212    0.000    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:185(adagrad)
  636/424    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      212    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
      212    0.002    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:245(_single_tensor_adagrad)
      212    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      212    0.003    0.000    0.003    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      212    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      212    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      212    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      212    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    43857    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      424    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      212    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      212    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      424    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      424    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    18800    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      424    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      212    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      424    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
      212    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:87(_init_group)
    15049    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    12559    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      212    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      212    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
    14619    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      424    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      424    0.000    0.000    0.000    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      424    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      424    0.000    0.000    0.000    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      424    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      428    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      650    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      212    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      638    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      636    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:207(<genexpr>)
      212    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      636    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
      436    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      641    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
1102/1098    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      424    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      426    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
     1062    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      853    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      642    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      215    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:13(__init__)
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      428    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      424    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      436    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      212    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
      212    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      213    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      216    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      214    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      212    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      229    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      212    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.full_like}
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Adagrad Pytorch. # 2
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 3.7 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.9 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.7 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/adagrad.py:56: 0.1 KiB
    state["step"] = torch.tensor(0.0)
#5: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
5 other: 0.4 KiB
Total allocated size: 5.9 KiB
========================================================================================================================
TIME. PROFILING: Adagrad Pytorch. # 3
========================================================================================================================
         176243 function calls (176023 primitive calls) in 0.060 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.065    0.065 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:52(<lambda>)
        1    0.000    0.000    0.065    0.065 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:113(adagrad_stochastic_grad_down)
        1    0.001    0.001    0.065    0.065 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      215    0.011    0.000    0.047    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    14815    0.002    0.000    0.016    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    14815    0.007    0.000    0.014    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      434    0.008    0.000    0.008    0.000 {built-in method torch.tensor}
      214    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      214    0.000    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    14815    0.004    0.000    0.005    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      215    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      214    0.000    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:101(step)
      214    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:185(adagrad)
      214    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
  642/428    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      214    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:245(_single_tensor_adagrad)
      214    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      214    0.003    0.000    0.003    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      214    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      214    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      214    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      214    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    44445    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      428    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      214    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      214    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      428    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      428    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    18870    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      428    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      214    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      428    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
      214    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:87(_init_group)
    15249    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    12677    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
    14815    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
      214    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      214    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      428    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      428    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      428    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      428    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      428    0.000    0.000    0.000    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      428    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      428    0.000    0.000    0.000    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      428    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      214    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      432    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      214    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      656    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      644    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      214    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      642    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:207(<genexpr>)
      440    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      642    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      647    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
1112/1108    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      214    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
      428    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
      428    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      430    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
     1072    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      861    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      648    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      217    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:13(__init__)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      214    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      428    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      214    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      432    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      440    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      214    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      428    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
      428    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
      214    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      218    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      216    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      214    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
      215    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      214    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
      231    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
      214    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 {built-in method torch.full_like}
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Adagrad Pytorch. # 3
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 2.1 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 1.3 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.5 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/adagrad.py:56: 0.1 KiB
    state["step"] = torch.tensor(0.0)
#5: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
6 other: 0.4 KiB
Total allocated size: 4.6 KiB
========================================================================================================================
TIME. PROFILING: Adagrad Pytorch. # 4
========================================================================================================================
         168227 function calls (168015 primitive calls) in 0.060 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.066    0.066 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:52(<lambda>)
        1    0.000    0.000    0.066    0.066 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:113(adagrad_stochastic_grad_down)
        1    0.001    0.001    0.065    0.065 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      207    0.010    0.000    0.047    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    14092    0.002    0.000    0.016    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    14092    0.007    0.000    0.014    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      418    0.009    0.000    0.009    0.000 {built-in method torch.tensor}
      206    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      206    0.000    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      206    0.000    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:101(step)
    14092    0.004    0.000    0.005    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      207    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      206    0.000    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:185(adagrad)
  618/412    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      206    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
      206    0.002    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:245(_single_tensor_adagrad)
      206    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      206    0.003    0.000    0.003    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      206    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      206    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      206    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      206    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    42276    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      412    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      206    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      206    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      412    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      412    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    18078    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      412    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
      206    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      412    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      206    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:87(_init_group)
    14510    0.001    0.000    0.001    0.000 {built-in method builtins.len}
      206    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    12205    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
    14092    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
      206    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      412    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      412    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      412    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      412    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      412    0.000    0.000    0.000    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      412    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      412    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      412    0.000    0.000    0.000    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      206    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      416    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      632    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      206    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      620    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      206    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      618    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:207(<genexpr>)
      618    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      623    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
1072/1068    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      206    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
      412    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      412    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      414    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
     1032    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      209    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      624    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      829    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adagrad.py:13(__init__)
      206    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      412    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      206    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      424    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      416    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      206    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      412    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      412    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
      206    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      210    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      207    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      208    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      206    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
      206    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
      223    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
      206    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.full_like}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: Adagrad Pytorch. # 4
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 1.7 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.8 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.5 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/adagrad.py:56: 0.1 KiB
    state["step"] = torch.tensor(0.0)
#5: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
5 other: 0.4 KiB
Total allocated size: 3.7 KiB
========================================================================================================================
TIME. PROFILING: RMS. # 0
========================================================================================================================
         8206238 function calls in 1.487 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.487    1.487 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:56(<lambda>)
        1    0.069    0.069    1.487    1.487 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:158(rms_stochastic_grad_down)
    10000    0.399    0.000    1.383    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688288    0.107    0.000    0.742    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688288    0.324    0.000    0.635    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688288    0.188    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.064    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2064864    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1406577    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   881650    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   109997    0.027    0.000    0.032    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688288    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   510000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.015    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
   189997    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
     9996    0.001    0.000    0.001    0.000 {method 'pop' of 'list' objects}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: RMS. # 0
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.2 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: RMS. # 1
========================================================================================================================
         8204520 function calls in 1.490 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.490    1.490 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:56(<lambda>)
        1    0.069    0.069    1.490    1.490 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:158(rms_stochastic_grad_down)
    10000    0.400    0.000    1.386    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688179    0.107    0.000    0.744    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688179    0.325    0.000    0.637    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688179    0.190    0.000    0.250    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2064537    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1406359    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880913    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   109997    0.027    0.000    0.031    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688179    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   510000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.015    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
   189997    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
     9996    0.001    0.000    0.001    0.000 {method 'pop' of 'list' objects}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: RMS. # 1
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.2 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: RMS. # 2
========================================================================================================================
         8207766 function calls in 1.483 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.483    1.483 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:56(<lambda>)
        1    0.069    0.069    1.483    1.483 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:158(rms_stochastic_grad_down)
    10000    0.400    0.000    1.380    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688549    0.106    0.000    0.738    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688549    0.322    0.000    0.632    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688549    0.187    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.064    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2065647    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1407099    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880829    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   109997    0.027    0.000    0.031    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688549    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   510000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.015    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
   189997    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
     9996    0.001    0.000    0.001    0.000 {method 'pop' of 'list' objects}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: RMS. # 2
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.2 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: RMS. # 3
========================================================================================================================
         8201985 function calls in 1.477 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.477    1.477 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:56(<lambda>)
        1    0.068    0.068    1.477    1.477 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:158(rms_stochastic_grad_down)
    10000    0.395    0.000    1.374    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   687897    0.106    0.000    0.737    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687897    0.321    0.000    0.632    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   687897    0.188    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.094    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.064    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2063691    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1405795    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880916    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   109997    0.027    0.000    0.032    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   687897    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   510000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.015    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
   189997    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
     9996    0.001    0.000    0.001    0.000 {method 'pop' of 'list' objects}
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: RMS. # 3
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.2 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: RMS. # 4
========================================================================================================================
         8207828 function calls in 1.487 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.487    1.487 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:56(<lambda>)
        1    0.069    0.069    1.487    1.487 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:158(rms_stochastic_grad_down)
    10000    0.402    0.000    1.383    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688553    0.106    0.000    0.739    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688553    0.323    0.000    0.633    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688553    0.187    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.037    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2065659    0.062    0.000    0.062    0.000 {built-in method _operator.index}
  1407107    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880855    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   109997    0.027    0.000    0.032    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
   688553    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   510000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
    10000    0.011    0.000    0.015    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:234(diag)
    30000    0.006    0.000    0.012    0.000 {method 'transpose' of 'numpy.ndarray' objects}
    10000    0.008    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
   189997    0.008    0.000    0.008    0.000 {built-in method builtins.isinstance}
    40000    0.003    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
    10001    0.002    0.000    0.002    0.000 {built-in method numpy.zeros}
    10000    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/lib/twodim_base.py:230(_diag_dispatcher)
     9996    0.001    0.000    0.001    0.000 {method 'pop' of 'list' objects}
    10000    0.001    0.000    0.001    0.000 {built-in method numpy.asanyarray}
    10000    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: RMS. # 4
========================================================================================================================
Top 5 lines
#1: matrixlib/defmatrix.py:219: 0.2 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.2 KiB
========================================================================================================================
TIME. PROFILING: RMS Pytorch. # 0
========================================================================================================================
         369645 function calls (369183 primitive calls) in 0.126 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.138    0.138 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:60(<lambda>)
        1    0.000    0.000    0.138    0.138 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:123(rms_stochastic_grad_down)
        1    0.002    0.002    0.138    0.138 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      457    0.022    0.000    0.100    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    31537    0.005    0.000    0.034    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    31537    0.015    0.000    0.029    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      916    0.018    0.000    0.018    0.000 {built-in method torch.tensor}
      456    0.001    0.000    0.017    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      456    0.001    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
    31537    0.009    0.000    0.012    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      457    0.011    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      456    0.000    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:96(step)
 1368/912    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      456    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
      456    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:199(rmsprop)
      456    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      456    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:250(_single_tensor_rmsprop)
      456    0.006    0.000    0.006    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      456    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      456    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      456    0.001    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      456    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
      456    0.001    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:58(_init_group)
    94611    0.003    0.000    0.003    0.000 {built-in method _operator.index}
      912    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      456    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      456    0.002    0.000    0.002    0.000 {built-in method torch._C._nn.mse_loss}
      912    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      912    0.002    0.000    0.002    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
      912    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    40399    0.002    0.000    0.002    0.000 {method 'getrandbits' of '_random.Random' objects}
      912    0.002    0.000    0.002    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      456    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      912    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    33367    0.001    0.000    0.001    0.000 {built-in method builtins.len}
        2    0.001    0.001    0.001    0.001 {built-in method torch.zeros_like}
    31537    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
    26043    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      456    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      456    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      912    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      912    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      912    0.001    0.000    0.001    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      912    0.001    0.000    0.001    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      456    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      912    0.001    0.000    0.001    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      912    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler.}
      916    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      456    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
     1382    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      456    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      922    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
     1368    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
     1373    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      456    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      456    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      912    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      912    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      912    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
1410/1406    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
      458    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
     1829    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
     1374    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      459    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
     1370    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      912    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      916    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      456    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      456    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      922    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      456    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      912    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:12(__init__)
      456    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      460    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      458    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      456    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
      464    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      473    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      456    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
      456    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:262(profile_hook_step)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:35(update_wrapper)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        9    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:65(wraps)
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: RMS Pytorch. # 0
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 1.6 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.9 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.6 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/rmsprop.py:68: 0.1 KiB
    state = self.state[p]
#5: modules/module.py:1626: 0.1 KiB
    params = self.__dict__.get('_parameters')
12 other: 0.9 KiB
Total allocated size: 4.2 KiB
========================================================================================================================
TIME. PROFILING: RMS Pytorch. # 1
========================================================================================================================
         362683 function calls (362230 primitive calls) in 0.125 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.137    0.137 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:60(<lambda>)
        1    0.000    0.000    0.137    0.137 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:123(rms_stochastic_grad_down)
        1    0.002    0.002    0.137    0.137 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      448    0.022    0.000    0.100    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    30981    0.005    0.000    0.034    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    30981    0.015    0.000    0.029    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      898    0.018    0.000    0.018    0.000 {built-in method torch.tensor}
      447    0.001    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
    30981    0.009    0.000    0.011    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      447    0.001    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      448    0.011    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      447    0.000    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:96(step)
 1341/894    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      447    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
      447    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:199(rmsprop)
      447    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      447    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:250(_single_tensor_rmsprop)
      447    0.006    0.000    0.006    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      447    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      447    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      447    0.001    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      447    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    92943    0.003    0.000    0.003    0.000 {built-in method _operator.index}
      894    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      447    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      447    0.002    0.000    0.002    0.000 {built-in method torch._C._nn.mse_loss}
      894    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      894    0.002    0.000    0.002    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
      447    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:58(_init_group)
    39413    0.002    0.000    0.002    0.000 {method 'getrandbits' of '_random.Random' objects}
      894    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
      894    0.002    0.000    0.002    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      447    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      894    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    32775    0.001    0.000    0.001    0.000 {built-in method builtins.len}
      447    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    30981    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
    25530    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      447    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      894    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      894    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      894    0.001    0.000    0.001    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      894    0.001    0.000    0.001    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      447    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      894    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler.}
      894    0.001    0.000    0.001    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      898    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
     1355    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      447    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      447    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      904    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
     1341    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
     1346    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      447    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      447    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
      894    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      894    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      894    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
1383/1379    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
     1347    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
     1793    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      449    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      450    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
     1343    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      447    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      447    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      894    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      904    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      898    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      447    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      894    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      447    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      451    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      449    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      447    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
      448    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:12(__init__)
      447    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      447    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
      464    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 {built-in method torch.zeros_like}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        9    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: RMS Pytorch. # 1
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 3.6 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/functional.py:74: 0.7 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#3: torch/_ops.py:502: 0.7 KiB
    return self._op(*args, **kwargs or {})
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
3 other: 0.2 KiB
Total allocated size: 5.4 KiB
========================================================================================================================
TIME. PROFILING: RMS Pytorch. # 2
========================================================================================================================
         365573 function calls (365116 primitive calls) in 0.125 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.137    0.137 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:60(<lambda>)
        1    0.000    0.000    0.137    0.137 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:123(rms_stochastic_grad_down)
        1    0.002    0.002    0.137    0.137 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      452    0.022    0.000    0.100    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    31191    0.005    0.000    0.034    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    31191    0.015    0.000    0.029    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      906    0.018    0.000    0.018    0.000 {built-in method torch.tensor}
      451    0.001    0.000    0.016    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
    31191    0.009    0.000    0.012    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      451    0.001    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      452    0.011    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      451    0.000    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:96(step)
 1353/902    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      451    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
      451    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:199(rmsprop)
      451    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      451    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:250(_single_tensor_rmsprop)
      451    0.005    0.000    0.005    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      451    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      451    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      451    0.001    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      451    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    93573    0.003    0.000    0.003    0.000 {built-in method _operator.index}
      902    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      451    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      451    0.002    0.000    0.002    0.000 {built-in method torch._C._nn.mse_loss}
      902    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      902    0.002    0.000    0.002    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
      451    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:58(_init_group)
      902    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    39951    0.002    0.000    0.002    0.000 {method 'getrandbits' of '_random.Random' objects}
      902    0.002    0.000    0.002    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      902    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
      451    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
    33001    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    25758    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
    31191    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
      451    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      451    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      902    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      902    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      902    0.001    0.000    0.001    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      902    0.001    0.000    0.001    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      451    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      902    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler.}
      902    0.001    0.000    0.001    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      906    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
     1367    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      451    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      451    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      912    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
     1353    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
     1358    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      451    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      451    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
      902    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      902    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      902    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
1395/1391    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
     1359    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
     1809    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      453    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      454    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
     1355    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      902    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      451    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      906    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      451    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      451    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      912    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      451    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      902    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      453    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      451    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      455    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      468    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      452    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:12(__init__)
      451    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      451    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 {built-in method torch.zeros_like}
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        9    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: RMS Pytorch. # 2
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 3.8 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.6 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.4 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
5 other: 0.3 KiB
Total allocated size: 5.3 KiB
========================================================================================================================
TIME. PROFILING: RMS Pytorch. # 3
========================================================================================================================
         356138 function calls (355689 primitive calls) in 0.124 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.135    0.135 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:60(<lambda>)
        1    0.000    0.000    0.135    0.135 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:123(rms_stochastic_grad_down)
        1    0.002    0.002    0.135    0.135 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      444    0.022    0.000    0.099    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    30330    0.005    0.000    0.034    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    30330    0.015    0.000    0.029    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      890    0.018    0.000    0.018    0.000 {built-in method torch.tensor}
      443    0.001    0.000    0.015    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
    30330    0.009    0.000    0.011    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      444    0.011    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      443    0.001    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      443    0.000    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:96(step)
      443    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
 1329/886    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      443    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:199(rmsprop)
      443    0.001    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      443    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:250(_single_tensor_rmsprop)
      443    0.006    0.000    0.006    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      443    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      443    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      443    0.001    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      443    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    90990    0.003    0.000    0.003    0.000 {built-in method _operator.index}
      886    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      443    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      443    0.002    0.000    0.002    0.000 {built-in method torch._C._nn.mse_loss}
      886    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      886    0.002    0.000    0.002    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
      443    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:58(_init_group)
      886    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    38748    0.002    0.000    0.002    0.000 {method 'getrandbits' of '_random.Random' objects}
      886    0.002    0.000    0.002    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      443    0.002    0.000    0.002    0.000 {built-in method torch._C._nn.linear}
      886    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    32108    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    30330    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
    25302    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      443    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      443    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      886    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      886    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      886    0.001    0.000    0.001    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      886    0.001    0.000    0.001    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      443    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      886    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler.}
      886    0.001    0.000    0.001    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      890    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
     1343    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      443    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      443    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      896    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
     1334    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
     1329    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
      443    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      443    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
      886    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      886    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      886    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
1371/1367    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      445    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
     1777    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
     1335    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      446    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
     1331    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
      443    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      886    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      443    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      890    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      896    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      443    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      886    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
      443    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      445    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      444    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      443    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
      447    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      443    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
      460    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:12(__init__)
      443    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.zeros_like}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        9    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: RMS Pytorch. # 3
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 3.7 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/functional.py:74: 0.4 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#3: torch/_ops.py:502: 0.4 KiB
    return self._op(*args, **kwargs or {})
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
4 other: 0.2 KiB
Total allocated size: 5.0 KiB
========================================================================================================================
TIME. PROFILING: RMS Pytorch. # 4
========================================================================================================================
         339600 function calls (339175 primitive calls) in 0.116 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.127    0.127 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:60(<lambda>)
        1    0.000    0.000    0.127    0.127 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:123(rms_stochastic_grad_down)
        1    0.001    0.001    0.127    0.127 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      420    0.021    0.000    0.093    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    28978    0.005    0.000    0.032    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    28978    0.014    0.000    0.027    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      842    0.017    0.000    0.017    0.000 {built-in method torch.tensor}
      419    0.001    0.000    0.014    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
    28978    0.008    0.000    0.011    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      420    0.011    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      419    0.001    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      419    0.000    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:96(step)
 1257/838    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      419    0.000    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
      419    0.000    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:199(rmsprop)
      419    0.001    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      419    0.001    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:250(_single_tensor_rmsprop)
      419    0.005    0.000    0.005    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      419    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      419    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      419    0.001    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      419    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    86934    0.003    0.000    0.003    0.000 {built-in method _operator.index}
      838    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      419    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      419    0.002    0.000    0.002    0.000 {built-in method torch._C._nn.mse_loss}
      838    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      838    0.002    0.000    0.002    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
      419    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:58(_init_group)
      838    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    37058    0.002    0.000    0.002    0.000 {method 'getrandbits' of '_random.Random' objects}
      838    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      419    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      838    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    30660    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    28978    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
    23934    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      419    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      419    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      838    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      838    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      838    0.001    0.000    0.001    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      838    0.001    0.000    0.001    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      419    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      838    0.001    0.000    0.001    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      838    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler.}
      842    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
     1271    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      419    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      419    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      848    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
     1262    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
     1257    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
      419    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      419    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
      838    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      838    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      838    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
1299/1295    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      421    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
     1263    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
     1681    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      422    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
     1259    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      419    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      838    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      419    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      848    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      842    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      419    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      838    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
      419    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/rmsprop.py:12(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      421    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      419    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
      420    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      423    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      419    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
      436    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      419    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 {built-in method torch.zeros_like}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        9    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: RMS Pytorch. # 4
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 4.0 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 1.4 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 1.0 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
#5: modules/linear.py:96: 0.1 KiB
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
4 other: 0.2 KiB
Total allocated size: 6.9 KiB
========================================================================================================================
TIME. PROFILING: Adam. # 0
========================================================================================================================
         8342731 function calls in 1.519 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.519    1.519 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:64(<lambda>)
        1    0.065    0.065    1.519    1.519 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:197(adam_stochastic_grad_down)
    10000    0.403    0.000    1.386    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688050    0.107    0.000    0.739    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688050    0.322    0.000    0.633    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688050    0.188    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.038    0.000    0.095    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.057    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2064150    0.063    0.000    0.063    0.000 {built-in method _operator.index}
   189999    0.046    0.000    0.053    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
    49998    0.035    0.000    0.052    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
  1386100    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880283    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   688050    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
   269999    0.011    0.000    0.011    0.000 {built-in method builtins.isinstance}
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
    79998    0.006    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adam. # 0
========================================================================================================================
Top 5 lines
#1: lab2/linear_regression.py:208: 0.1 KiB
    b -= alpha * m / (np.sqrt(u) + 0.1 ** 8)
#2: matrixlib/defmatrix.py:219: 0.0 KiB
    return N.dot(self, asmatrix(other))
#3: lab2/linear_regression.py:205: 0.0 KiB
    u = b2 * u + (1 - b2) * np.square(l)
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Adam. # 1
========================================================================================================================
         8341007 function calls in 1.513 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.513    1.513 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:64(<lambda>)
        1    0.065    0.065    1.513    1.513 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:197(adam_stochastic_grad_down)
    10000    0.400    0.000    1.380    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   687874    0.107    0.000    0.739    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   687874    0.322    0.000    0.632    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   687874    0.188    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.038    0.000    0.094    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2063622    0.062    0.000    0.062    0.000 {built-in method _operator.index}
   189999    0.046    0.000    0.053    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
    49998    0.035    0.000    0.052    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
  1385748    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880143    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   687874    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
   269999    0.011    0.000    0.011    0.000 {built-in method builtins.isinstance}
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
    79998    0.006    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adam. # 1
========================================================================================================================
Top 5 lines
#1: lab2/linear_regression.py:208: 0.1 KiB
    b -= alpha * m / (np.sqrt(u) + 0.1 ** 8)
#2: matrixlib/defmatrix.py:219: 0.0 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Adam. # 2
========================================================================================================================
         8349299 function calls in 1.508 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.508    1.508 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:64(<lambda>)
        1    0.065    0.065    1.508    1.508 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:197(adam_stochastic_grad_down)
    10000    0.396    0.000    1.375    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688703    0.106    0.000    0.738    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688703    0.321    0.000    0.632    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688703    0.188    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.038    0.000    0.094    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2066109    0.062    0.000    0.062    0.000 {built-in method _operator.index}
   189999    0.046    0.000    0.053    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
    49998    0.035    0.000    0.052    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
  1387406    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.010    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880974    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   688703    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.021    0.000    0.021    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
   269999    0.011    0.000    0.011    0.000 {built-in method builtins.isinstance}
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
    79998    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adam. # 2
========================================================================================================================
Top 5 lines
#1: lab2/linear_regression.py:208: 0.1 KiB
    b -= alpha * m / (np.sqrt(u) + 0.1 ** 8)
#2: matrixlib/defmatrix.py:219: 0.0 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Adam. # 3
========================================================================================================================
         8347587 function calls in 1.513 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.513    1.513 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:64(<lambda>)
        1    0.065    0.065    1.513    1.513 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:197(adam_stochastic_grad_down)
    10000    0.401    0.000    1.380    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688484    0.106    0.000    0.738    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688484    0.321    0.000    0.632    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688484    0.187    0.000    0.248    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.038    0.000    0.094    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2065452    0.062    0.000    0.062    0.000 {built-in method _operator.index}
   189999    0.046    0.000    0.053    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
    49998    0.035    0.000    0.052    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
  1386968    0.051    0.000    0.051    0.000 {built-in method builtins.len}
    30000    0.009    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   881233    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   688484    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
   269999    0.011    0.000    0.011    0.000 {built-in method builtins.isinstance}
    20000    0.005    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
    79998    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adam. # 3
========================================================================================================================
Top 5 lines
#1: lab2/linear_regression.py:208: 0.1 KiB
    b -= alpha * m / (np.sqrt(u) + 0.1 ** 8)
#2: matrixlib/defmatrix.py:219: 0.0 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: Adam. # 4
========================================================================================================================
         8343939 function calls in 1.517 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.517    1.517 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:64(<lambda>)
        1    0.065    0.065    1.517    1.517 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:197(adam_stochastic_grad_down)
    10000    0.401    0.000    1.383    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab2/linear_regression.py:22(get_grad_in_point)
   688112    0.107    0.000    0.740    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
   688112    0.322    0.000    0.633    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
   688112    0.188    0.000    0.249    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
    30000    0.038    0.000    0.094    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:216(__mul__)
    20000    0.056    0.000    0.063    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
  2064336    0.062    0.000    0.062    0.000 {built-in method _operator.index}
   189999    0.046    0.000    0.053    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
    49998    0.035    0.000    0.052    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:224(__rmul__)
  1386224    0.050    0.000    0.050    0.000 {built-in method builtins.len}
    30000    0.010    0.000    0.045    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:37(asmatrix)
   880933    0.036    0.000    0.036    0.000 {method 'getrandbits' of '_random.Random' objects}
    30000    0.012    0.000    0.035    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:116(__new__)
   688112    0.025    0.000    0.025    0.000 {method 'bit_length' of 'int' objects}
    30000    0.022    0.000    0.022    0.000 {built-in method _warnings.warn}
   500000    0.021    0.000    0.021    0.000 {method 'append' of 'list' objects}
   269999    0.011    0.000    0.011    0.000 {built-in method builtins.isinstance}
    20000    0.004    0.000    0.010    0.000 {method 'transpose' of 'numpy.ndarray' objects}
    79998    0.006    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/core/multiarray.py:741(dot)
        1    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


========================================================================================================================
MEM. PROFILING: Adam. # 4
========================================================================================================================
Top 5 lines
#1: lab2/linear_regression.py:208: 0.1 KiB
    b -= alpha * m / (np.sqrt(u) + 0.1 ** 8)
#2: matrixlib/defmatrix.py:219: 0.0 KiB
    return N.dot(self, asmatrix(other))
Total allocated size: 0.1 KiB
========================================================================================================================
TIME. PROFILING: ADAM Pytorch. # 0
========================================================================================================================
         177898 function calls (177682 primitive calls) in 0.063 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.069    0.069 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:68(<lambda>)
        1    0.000    0.000    0.069    0.069 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:133(adam_stochastic_grad_down)
        1    0.001    0.001    0.068    0.068 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      211    0.010    0.000    0.046    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    14547    0.002    0.000    0.016    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    14547    0.007    0.000    0.014    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      210    0.001    0.000    0.012    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      210    0.000    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      210    0.000    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:108(step)
      426    0.008    0.000    0.008    0.000 {built-in method torch.tensor}
      210    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:231(adam)
      210    0.003    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:300(_single_tensor_adam)
    14547    0.004    0.000    0.005    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      211    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      210    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
  630/420    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      210    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      210    0.003    0.000    0.003    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      210    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      210    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      210    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      210    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    43641    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      840    0.001    0.000    0.001    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
      420    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      210    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      840    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      210    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      420    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      210    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:66(_init_group)
      420    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    18545    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      210    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      420    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    15393    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    12861    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      210    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      210    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    14547    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
      420    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      420    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      420    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      420    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      420    0.000    0.000    0.000    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      420    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:52(_dispatch_sqrt)
      420    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      210    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      420    0.000    0.000    0.000    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      420    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      210    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      644    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      630    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:268(<genexpr>)
      632    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
1512/1508    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
      210    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      430    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      635    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      630    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
      210    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
      420    0.000    0.000    0.000    0.000 {method 'conj' of 'torch._C._TensorBase' objects}
     1472    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      420    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      420    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      420    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:14(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      636    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      845    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      638    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      213    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      425    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
      210    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      424    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      420    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      210    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      430    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      210    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:228(_cuda_graph_capture_health_check)
      210    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      420    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
      420    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
      214    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      210    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
      212    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
      210    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
      210    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
      227    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
      210    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:262(profile_hook_step)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:35(update_wrapper)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        4    0.000    0.000    0.000    0.000 {built-in method torch.zeros_like}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
       10    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/functools.py:65(wraps)
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: ADAM Pytorch. # 0
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 3.7 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.7 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.5 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/adam.py:89: 0.1 KiB
    else torch.tensor(0.)
#5: optim/adam.py:83: 0.1 KiB
    state = self.state[p]
13 other: 1.0 KiB
Total allocated size: 6.2 KiB
========================================================================================================================
TIME. PROFILING: ADAM Pytorch. # 1
========================================================================================================================
         180027 function calls (179810 primitive calls) in 0.062 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.068    0.068 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:68(<lambda>)
        1    0.000    0.000    0.068    0.068 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:133(adam_stochastic_grad_down)
        1    0.001    0.001    0.068    0.068 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      212    0.010    0.000    0.047    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    14739    0.002    0.000    0.016    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    14739    0.007    0.000    0.014    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      211    0.001    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      211    0.000    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      211    0.000    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:108(step)
      428    0.008    0.000    0.008    0.000 {built-in method torch.tensor}
      211    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:231(adam)
      211    0.003    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:300(_single_tensor_adam)
    14739    0.004    0.000    0.005    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      212    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
  633/422    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      211    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
      211    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      211    0.003    0.000    0.003    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      211    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      211    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      211    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
    44217    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      211    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
      844    0.001    0.000    0.001    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
      422    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      844    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      211    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      211    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      422    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      211    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:66(_init_group)
    18951    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      422    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
      211    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      422    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    15589    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    12922    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
    14739    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
      211    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      422    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:52(_dispatch_sqrt)
      422    0.000    0.000    0.000    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      422    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      422    0.000    0.000    0.000    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      422    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      426    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      647    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      211    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      635    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      633    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:268(<genexpr>)
1519/1515    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      432    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      211    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      633    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
      638    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
     1479    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      422    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      422    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
      422    0.000    0.000    0.000    0.000 {method 'conj' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
      849    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      639    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      214    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      634    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      427    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
      422    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      426    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      432    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:14(__init__)
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      211    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:228(_cuda_graph_capture_health_check)
      422    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
      211    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      215    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      211    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
      213    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      211    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      228    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      211    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        4    0.000    0.000    0.000    0.000 {built-in method torch.zeros_like}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
       10    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: ADAM Pytorch. # 1
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 1.0 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.4 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.3 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/adam.py:89: 0.1 KiB
    else torch.tensor(0.)
#5: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
6 other: 0.4 KiB
Total allocated size: 2.4 KiB
========================================================================================================================
TIME. PROFILING: ADAM Pytorch. # 2
========================================================================================================================
         186360 function calls (186135 primitive calls) in 0.069 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.075    0.075 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:68(<lambda>)
        1    0.000    0.000    0.075    0.075 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:133(adam_stochastic_grad_down)
        1    0.001    0.001    0.074    0.074 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      220    0.011    0.000    0.050    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    15254    0.002    0.000    0.017    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    15254    0.007    0.000    0.015    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      219    0.001    0.000    0.013    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      219    0.000    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      219    0.000    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:108(step)
      444    0.009    0.000    0.009    0.000 {built-in method torch.tensor}
      219    0.000    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:231(adam)
      219    0.003    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:300(_single_tensor_adam)
    15254    0.004    0.000    0.006    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      220    0.006    0.000    0.006    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      219    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
  657/438    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      219    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      219    0.003    0.000    0.003    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      219    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      219    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      219    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      219    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
      876    0.002    0.000    0.002    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
    45762    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      438    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      219    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      219    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      876    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      438    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      219    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:66(_init_group)
      438    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    19540    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      219    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      438    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    16136    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    13410    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
    15254    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
      219    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      219    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      438    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      438    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      438    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      438    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      438    0.000    0.000    0.000    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      438    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:52(_dispatch_sqrt)
      438    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      438    0.000    0.000    0.000    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      219    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      438    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      442    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      219    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      671    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      659    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
1575/1571    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      657    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:268(<genexpr>)
      219    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      448    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      662    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      657    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
      219    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
     1535    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      438    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      438    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
      438    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
      438    0.000    0.000    0.000    0.000 {method 'conj' of 'torch._C._TensorBase' objects}
      881    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      663    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      658    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      222    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      219    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      443    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
      219    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:14(__init__)
      438    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      219    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      219    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:228(_cuda_graph_capture_health_check)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      448    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      442    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      219    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      438    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
      438    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      223    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      221    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      219    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
      236    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
      219    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
      219    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        4    0.000    0.000    0.000    0.000 {built-in method torch.zeros_like}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
       10    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: ADAM Pytorch. # 2
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 4.3 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 0.5 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 0.3 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/adam.py:89: 0.1 KiB
    else torch.tensor(0.)
#5: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
6 other: 0.4 KiB
Total allocated size: 5.8 KiB
========================================================================================================================
TIME. PROFILING: ADAM Pytorch. # 3
========================================================================================================================
         166622 function calls (166421 primitive calls) in 0.059 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.064    0.064 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:68(<lambda>)
        1    0.000    0.000    0.064    0.064 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:133(adam_stochastic_grad_down)
        1    0.001    0.001    0.064    0.064 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      196    0.010    0.000    0.044    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    13649    0.002    0.000    0.015    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    13649    0.007    0.000    0.013    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      195    0.001    0.000    0.011    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      195    0.000    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      195    0.000    0.000    0.009    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:108(step)
      396    0.008    0.000    0.008    0.000 {built-in method torch.tensor}
      195    0.000    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:231(adam)
      195    0.003    0.000    0.007    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:300(_single_tensor_adam)
    13649    0.004    0.000    0.005    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      196    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
      195    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
  585/390    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      195    0.000    0.000    0.003    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      195    0.002    0.000    0.002    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      195    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      195    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      195    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      195    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
    40947    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      780    0.001    0.000    0.001    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
      780    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      195    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      390    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      195    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      390    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      195    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:66(_init_group)
    17514    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      390    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
      195    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      390    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    14435    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    11946    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
    13649    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
      195    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
      195    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      390    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      390    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      390    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      390    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      390    0.000    0.000    0.000    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      390    0.000    0.000    0.000    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      390    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:52(_dispatch_sqrt)
      390    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      195    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      390    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      394    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      599    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      195    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      587    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      585    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:268(<genexpr>)
1407/1403    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      195    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      400    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      585    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
      590    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      195    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
     1367    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      390    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
      390    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
      390    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
      390    0.000    0.000    0.000    0.000 {method 'conj' of 'torch._C._TensorBase' objects}
      591    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      785    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      198    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      586    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:14(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      195    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      395    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      394    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      390    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      195    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      195    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
      195    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:228(_cuda_graph_capture_health_check)
      390    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
      390    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
      195    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
      199    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
      195    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
      197    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      212    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      195    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
      195    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        4    0.000    0.000    0.000    0.000 {built-in method torch.zeros_like}
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
       10    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}


========================================================================================================================
MEM. PROFILING: ADAM Pytorch. # 3
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 0.9 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/functional.py:74: 0.3 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#3: torch/_ops.py:502: 0.3 KiB
    return self._op(*args, **kwargs or {})
#4: optim/adam.py:89: 0.1 KiB
    else torch.tensor(0.)
#5: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
6 other: 0.4 KiB
Total allocated size: 2.3 KiB
========================================================================================================================
TIME. PROFILING: ADAM Pytorch. # 4
========================================================================================================================
         179319 function calls (179101 primitive calls) in 0.067 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.072    0.072 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/test_efficient.py:68(<lambda>)
        1    0.000    0.000    0.072    0.072 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:133(adam_stochastic_grad_down)
        1    0.001    0.001    0.072    0.072 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:44(_grad_down)
      213    0.011    0.000    0.049    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:6(take_batch)
    14633    0.002    0.000    0.017    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:358(randint)
    14633    0.007    0.000    0.014    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:284(randrange)
      212    0.001    0.000    0.013    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:265(wrapper)
      212    0.000    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:29(_use_grad)
      212    0.000    0.000    0.010    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:108(step)
      430    0.009    0.000    0.009    0.000 {built-in method torch.tensor}
      212    0.000    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:231(adam)
      212    0.003    0.000    0.008    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:300(_single_tensor_adam)
    14633    0.004    0.000    0.006    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/random.py:235(_randbelow_with_getrandbits)
      213    0.005    0.000    0.005    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:13(<listcomp>)
  636/424    0.001    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1494(_call_impl)
      212    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:428(backward)
      212    0.000    0.000    0.004    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:106(backward)
      212    0.003    0.000    0.003    0.000 {method 'run_backward' of 'torch._C._EngineBase' objects}
      212    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:535(forward)
      212    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/functional.py:3267(mse_loss)
      212    0.001    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:435(zero_grad)
      212    0.000    0.000    0.002    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:23(forward)
      848    0.001    0.000    0.001    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
    43899    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      424    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:491(__enter__)
      212    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:113(forward)
      212    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.mse_loss}
      848    0.001    0.000    0.001    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
      424    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:495(__exit__)
      212    0.001    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:66(_init_group)
      424    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:497(__call__)
    18888    0.001    0.000    0.001    0.000 {method 'getrandbits' of '_random.Random' objects}
      212    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.linear}
      424    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
    15487    0.001    0.000    0.001    0.000 {built-in method builtins.len}
    12983    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      212    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/functional.py:45(broadcast_tensors)
    14633    0.001    0.000    0.001    0.000 {method 'bit_length' of 'int' objects}
      212    0.000    0.000    0.001    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:50(_make_grads)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:39(_get_value)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_ops.py:286(__call__)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/profiler.py:482(__init__)
      424    0.000    0.000    0.000    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
      424    0.000    0.000    0.000    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:52(_dispatch_sqrt)
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:64(_default_to_fused_or_foreach)
      424    0.000    0.000    0.000    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
      424    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler.}
      424    0.000    0.000    0.000    0.000 {built-in method builtins.all}
      428    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:149(__init__)
      212    0.000    0.000    0.000    0.000 {built-in method torch.ones_like}
      650    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1601(__getattr__)
      638    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      212    0.000    0.000    0.000    0.000 {built-in method torch.broadcast_tensors}
      636    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:268(<genexpr>)
1526/1522    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      434    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_tensor.py:942(__hash__)
      641    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      636    0.000    0.000    0.000    0.000 {built-in method torch._C._get_tracing_state}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:17(__init__)
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_VF.py:26(__getattr__)
     1486    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_jit_internal.py:1102(is_scripting)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:72(<genexpr>)
      424    0.000    0.000    0.000    0.000 /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/typing.py:352(inner)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:90(__init__)
      424    0.000    0.000    0.000    0.000 {built-in method torch.is_complex}
      424    0.000    0.000    0.000    0.000 {method 'conj' of 'torch._C._TensorBase' objects}
      642    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
      215    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      853    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      637    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        8    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1617(__setattr__)
      429    0.000    0.000    0.000    0.000 {built-in method math.sqrt}
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/_reduction.py:7(get_enum)
      424    0.000    0.000    0.000    0.000 {method '__exit__' of 'torch._C.DisableTorchFunctionSubclass' objects}
      428    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      434    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/__init__.py:98(_tensor_or_tensors_to_tuple)
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:228(_cuda_graph_capture_health_check)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/adam.py:14(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:169(__init__)
      212    0.000    0.000    0.000    0.000 {built-in method torch._C._are_functorch_transforms_active}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/linear.py:103(reset_parameters)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/jit/__init__.py:89(annotate)
      424    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/_utils.py:786(is_compiling)
      212    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      216    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      214    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_variadic}
      212    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:366(kaiming_uniform_)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:437(__init__)
      229    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      212    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:539(register_parameter)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2059(parameters)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2084(named_parameters)
      212    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:249(_optimizer_step_code)
        3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2045(_named_members)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:190(__getitem__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:532(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:489(add_param_group)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/loss.py:20(__init__)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:30(__new__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/lab4/linear/pytorch_linear_regression.py:27(get_points)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:122(uniform_)
        4    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/parameter.py:8(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method torch.empty}
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:356(_calculate_correct_fan)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:284(_calculate_fan_in_and_fan_out)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:12(_no_grad_uniform_)
        2    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        6    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/numpy/matrixlib/defmatrix.py:168(__array_finalize__)
        4    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
        4    0.000    0.000    0.000    0.000 {built-in method torch.zeros_like}
      5/3    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2224(named_modules)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:53(__enter__)
        4    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 {method 'uniform_' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
        2    0.000    0.000    0.000    0.000 {built-in method torch.from_numpy}
        5    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1618(remove_from)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:48(__init__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/optim/optimizer.py:291(_patch_step_function)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/autograd/grad_mode.py:57(__exit__)
        1    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/init.py:67(calculate_gain)
        2    0.000    0.000    0.000    0.000 /Users/vnazarov/PycharmProjects/methodsOptimization/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:2113(<lambda>)
       10    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        4    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x12fa1d440}
        4    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}


========================================================================================================================
MEM. PROFILING: ADAM Pytorch. # 4
========================================================================================================================
Top 5 lines
#1: linear/pytorch_linear_regression.py:13: 2.1 KiB
    return torch.tensor([[x_tensor[i]] for i in select]), torch.tensor([[y_tensor[i]] for i in select])
#2: torch/_ops.py:502: 1.7 KiB
    return self._op(*args, **kwargs or {})
#3: torch/functional.py:74: 1.1 KiB
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
#4: optim/adam.py:89: 0.1 KiB
    else torch.tensor(0.)
#5: modules/linear.py:98: 0.1 KiB
    self.bias = Parameter(torch.empty(out_features, **factory_kwargs))
5 other: 0.4 KiB
Total allocated size: 5.5 KiB
========================================================================================================================
